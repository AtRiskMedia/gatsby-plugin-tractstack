{"version":3,"file":"build-menu.js","names":["React","Link","GatsbyImage","StyledWrapperDiv","InjectCssAnimation","NavLink","children","to","CountChildrenOffset","items","index","level","next","field_level","length","ParseMenuItems","recurse","this_menu_item","field_slug","field_title","this_level","sub","skip_children","BuildMenu","data","logo","payload","relationships","field_svg_logo","localFile","publicURL","this_image_id","id","this_image","field_image_logo","childImageSharp","state","viewport","key","menuItems","field_menu_items"],"sources":["src/build-menu.js"],"sourcesContent":["import React from \"react\";\nimport { Link } from \"gatsby\";\nimport { GatsbyImage } from \"gatsby-plugin-image\";\nimport { StyledWrapperDiv, InjectCssAnimation } from \"./helpers\";\n\nconst NavLink = ({ children, to }) => (\n  <Link to={to} activeClassName=\"is-active\">\n    {children}\n  </Link>\n);\n\nfunction CountChildrenOffset(items, index = 0, level = 0) {\n  while (1) {\n    let next = items[index + 1] && items[index + 1]?.field_level;\n    index = index + 1;\n    if (index + 1 === items.length && items[index]?.field_level === level) {\n      return index;\n    }\n    if (next === level) {\n      return index;\n    }\n    if (index > items.length) {\n      return false;\n    }\n  }\n}\n\nfunction ParseMenuItems(items, index = 0, level = 0) {\n  if (typeof items === \"undefined\") return <></>;\n  let recurse,\n    this_menu_item = (\n      <NavLink to={`/${items[index]?.field_slug}`}>\n        {items[index]?.field_title}\n      </NavLink>\n    );\n\n  if (index === 0 && level === 0) {\n    // initial bootstrap of menu ul\n    if (items.length) recurse = ParseMenuItems(items, 0, 1);\n    return <ul>{recurse}</ul>;\n  }\n  if (level) {\n    let this_level = items[index]?.field_level - level;\n    let next =\n      items[index + 1] &&\n      items[index + 1]?.field_level - items[index]?.field_level;\n\n    if (next === 0) {\n      recurse = ParseMenuItems(items, index + 1, level);\n      return (\n        <>\n          <li>{this_menu_item}</li> {recurse}\n        </>\n      );\n    } else if (next === -1 || typeof next === \"undefined\") {\n      return <li>{this_menu_item}</li>;\n    } else if (next === 1) {\n      // smart split sub-menu from remainder\n      let sub = ParseMenuItems(items, index + 1, level);\n      let skip_children = CountChildrenOffset(\n        items,\n        index,\n        items[index]?.field_level\n      );\n      if (skip_children) {\n        recurse = ParseMenuItems(\n          items,\n          skip_children,\n          items[skip_children]?.field_level\n        );\n        return (\n          <>\n            <li>\n              {this_menu_item}\n              <ul>{sub}</ul>\n            </li>\n            {recurse}\n          </>\n        );\n      } else {\n        return (\n          <>\n            <li>\n              {this_menu_item}\n              <ul>{sub}</ul>\n            </li>\n          </>\n        );\n      }\n    }\n  }\n}\n\nfunction BuildMenu(data) {\n  //console.log(\"BuildMenu\", data?.payload, data?.state, data?.hooks);\n\n  let logo;\n  // svg or image logo?\n  if (\n    typeof data?.payload?.relationships?.field_svg_logo?.localFile\n      ?.publicURL === \"string\"\n  ) {\n    // svg logo\n    let this_image_id = data?.payload?.relationships?.field_svg_logo?.id;\n    let this_image =\n      data?.payload?.relationships?.field_svg_logo?.localFile?.publicURL;\n    logo = <img src={this_image} className=\"menu__logo\" alt=\"Logo\" />;\n  } else if (\n    typeof data?.payload?.relationships?.field_image_logo?.localFile\n      ?.childImageSharp[data?.state?.viewport?.viewport?.key] !== \"undefined\"\n  ) {\n    let this_image_id = data?.payload?.relationships?.field_image_logo?.id;\n    let this_image =\n      data?.payload?.relationships?.field_image_logo?.localFile\n        ?.childImageSharp[data?.state?.viewport?.viewport?.key];\n    // image logo\n    logo = (\n      <GatsbyImage\n        key={this_image_id}\n        className=\"menu__logo\"\n        alt=\"Logo\"\n        image={this_image}\n        objectFit=\"contain\"\n      />\n    );\n  }\n  let menuItems = ParseMenuItems(\n    data?.payload?.relationships?.field_menu_items\n  );\n\n  return (\n    <>\n      <header role=\"banner\">\n        {logo}\n        <input type=\"checkbox\" id=\"nav-toggle\" className=\"nav-toggle\" />\n        <nav role=\"navigation\" className=\"menu-default\">\n          {menuItems}\n        </nav>\n        <label htmlFor=\"nav-toggle\" className=\"nav-toggle-label\">\n          <div className=\"innernav__toggle\">menu</div>\n          <span></span>\n        </label>\n      </header>\n    </>\n  );\n  //<div>{menuItems}</div>;\n}\n\nexport { BuildMenu };\n"],"mappings":"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"}