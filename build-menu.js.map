{"version":3,"file":"build-menu.js","names":["React","Link","GatsbyImage","StyledWrapperDiv","InjectCssAnimation","NavLink","children","to","MenuItems","items","index","recurse","this_menu_item","field_slug","field_title","field_level","length","sub","props","BuildMenu","data","logo","payload","relationships","field_svg_logo","localFile","publicURL","this_image_id","id","this_image","field_image_logo","childImageSharp","state","viewport","key","field_menu_items","map","i","menuItems"],"sources":["src/build-menu.js"],"sourcesContent":["import React from \"react\";\nimport { Link } from \"gatsby\";\nimport { GatsbyImage } from \"gatsby-plugin-image\";\nimport { StyledWrapperDiv, InjectCssAnimation } from \"./helpers\";\n\nconst NavLink = ({ children, to }) => (\n  <Link to={to} activeClassName=\"is-active\">\n    {children}\n  </Link>\n);\n\nfunction MenuItems(items, index = 0) {\n  if (typeof items === \"undefined\") return <></>;\n  let recurse,\n    this_menu_item = (\n      <NavLink to={`/${items[index]?.field_slug}`}>\n        {items[index]?.field_title}\n      </NavLink>\n    );\n  if (index) {\n    if (\n      (items[index]?.field_level === items[index - 1]?.field_level &&\n        items[index]?.field_level > items[index + 1]?.field_level) ||\n      items?.length === index + 1\n    ) {\n      return <li>{this_menu_item}</li>;\n    }\n    if (\n      items[index]?.field_level === items[index - 1]?.field_level &&\n      items[index]?.field_level <= items[index + 1]?.field_level\n    ) {\n      recurse = MenuItems(items, index + 1);\n      return (\n        <>\n          <li>{this_menu_item}</li>\n          {recurse}\n        </>\n      );\n    }\n    if (items[index]?.field_level > items[index - 1]?.field_level) {\n      // smart split sub-menu from remainder\n      let sub = MenuItems(items, index + 1);\n      if (items?.length >= sub?.props?.children?.length + index + 1)\n        recurse = MenuItems(items, sub?.props?.children?.length + index + 1);\n      return (\n        <>\n          <ul>\n            <li>{this_menu_item}</li>\n            {sub}\n          </ul>\n          {recurse}\n        </>\n      );\n    }\n  }\n  if (index === 0) {\n    if (items.length) recurse = MenuItems(items, index + 1);\n    return (\n      <ul>\n        <li>{this_menu_item}</li>\n        {recurse}\n      </ul>\n    );\n  }\n}\n\nfunction BuildMenu(data) {\n  //console.log(\"BuildMenu\", data?.payload, data?.state, data?.hooks);\n\n  let logo;\n  // svg or image logo?\n  if (\n    typeof data?.payload?.relationships?.field_svg_logo?.localFile\n      ?.publicURL === \"string\"\n  ) {\n    // svg logo\n    //console.log(\"svg\", data?.payload?.relationships?.field_svg_logo);\n    let this_image_id = data?.payload?.relationships?.field_svg_logo?.id;\n    let this_image = data?.payload?.relationships?.field_svg_logo?.publicURL;\n    logo = <img src={this_image} alt=\"Logo\" />;\n    //console.log(\"svg\", logo);\n  }\n  //else\n  if (\n    typeof data?.payload?.relationships?.field_image_logo?.localFile\n      ?.childImageSharp[data?.state?.viewport?.viewport?.key] !== \"undefined\"\n  ) {\n    let this_image_id = data?.payload?.relationships?.field_image_logo?.id;\n    let this_image =\n      data?.payload?.relationships?.field_image_logo?.localFile\n        ?.childImageSharp[data?.state?.viewport?.viewport?.key];\n    // image logo\n    logo = (\n      <GatsbyImage\n        key={this_image_id}\n        alt=\"Logo\"\n        image={this_image}\n        objectFit=\"contain\"\n      />\n    );\n    //console.log(\"img\", logo);\n  } else {\n    // no logo\n  }\n\n  data?.payload?.relationships?.field_menu_items.map((i) => {\n    //console.log(\"MenuItem\", i);\n  });\n\n  let menuItems = MenuItems(data?.payload?.relationships?.field_menu_items);\n\n  return <div>{menuItems}</div>;\n}\n\nexport { BuildMenu };\n"],"mappings":"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"}