{"version":3,"file":"build-controller.js","names":["React","Link","SvgShape","SvgPlay","SvgRewind","TractStackLogo","StyledWrapperDiv","InjectCssAnimation","BuildController","data","next","prev","link","react_fragment","effects_payload","controller_pane","state","storyStep","storyStepGraph","field_slug","previous","tempValue","viewport","shape","prefersReducedMotion","in","css","throttle","hook","limit","parameter","wait","setTimeout","window","addEventListener","hooks","hookScrolled","current","id","key"],"sources":["src/build-controller.js"],"sourcesContent":["import React from \"react\";\nimport { Link } from \"gatsby\";\nimport { SvgShape, SvgPlay, SvgRewind, TractStackLogo } from \"./shapes\";\nimport { StyledWrapperDiv, InjectCssAnimation } from \"./helpers\";\n\nfunction BuildController(data) {\n  let next, prev, link, react_fragment, effects_payload, controller_pane;\n  if (data?.state?.storyStep?.storyStepGraph?.next?.field_slug)\n    next = `/${data?.state?.storyStep?.storyStepGraph?.next?.field_slug}`;\n  if (data?.state?.storyStep?.storyStepGraph?.previous?.field_slug)\n    prev = `/${data?.state?.storyStep?.storyStepGraph?.previous?.field_slug}`;\n  let tempValue = SvgShape(\"mini\", {\n    viewport: data?.state?.viewport?.viewport,\n  });\n  if (tempValue) controller_pane = tempValue?.shape;\n\n  /*\n  <div className=\"controller__graph\">\n    {next ? (\n      <a onClick={() => data?.hooks?.hookGotoStoryFragment(next)}>\n        <SvgPlay />\n      </a>\n    ) : (\n      \"\"\n    )}\n    {prev ? (\n      <a onClick={() => data?.hooks?.hookGotoStoryFragment(prev)}>\n        <SvgRewind />\n      </a>\n    ) : (\n      \"\"\n    )}\n  </div>\n  */\n\n  // can we wrap this in animation?\n  if (data?.state?.prefersReducedMotion?.prefersReducedMotion === false) {\n    effects_payload = {\n      in: [\"fadeInRight\", 2, 1],\n    };\n  }\n  let css = InjectCssAnimation(effects_payload, \"tractstack-controller\");\n\n  // add debounced scroll listener for controller\n  function throttle(hook, limit, parameter) {\n    let wait = false;\n    return function () {\n      if (!wait) {\n        hook(parameter);\n        wait = true;\n        setTimeout(function () {\n          wait = false;\n        }, limit);\n      }\n    };\n  }\n  window.addEventListener(\"scroll\", throttle(data?.hooks?.hookScrolled, 1000));\n\n  return (\n    <section\n      key={data?.state?.storyStep?.storyStepGraph?.current?.id}\n      className=\"controller\"\n    >\n      <StyledWrapperDiv css={css}>\n        <div id=\"tractstack-controller\" className=\"controller__container\">\n          <div\n            className={`controller__view controller__view--${data?.state?.viewport?.viewport?.key}`}\n          >\n            <div id=\"calls-to-action\"></div>\n          </div>\n          <div\n            className={`controller__view controller__view--${data?.state?.viewport?.viewport?.key}`}\n          >\n            {controller_pane}\n          </div>\n        </div>\n      </StyledWrapperDiv>\n    </section>\n  );\n}\n\nexport { BuildController };\n"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,IAAT,QAAqB,QAArB;AACA,SAASC,QAAT,EAAmBC,OAAnB,EAA4BC,SAA5B,EAAuCC,cAAvC,QAA6D,UAA7D;AACA,SAASC,gBAAT,EAA2BC,kBAA3B,QAAqD,WAArD;;AAEA,SAASC,eAAT,CAAyBC,IAAzB,EAA+B;EAC7B,IAAIC,IAAJ,EAAUC,IAAV,EAAgBC,IAAhB,EAAsBC,cAAtB,EAAsCC,eAAtC,EAAuDC,eAAvD;EACA,IAAIN,IAAI,EAAEO,KAAN,EAAaC,SAAb,EAAwBC,cAAxB,EAAwCR,IAAxC,EAA8CS,UAAlD,EACET,IAAI,GAAI,IAAGD,IAAI,EAAEO,KAAN,EAAaC,SAAb,EAAwBC,cAAxB,EAAwCR,IAAxC,EAA8CS,UAAW,EAApE;EACF,IAAIV,IAAI,EAAEO,KAAN,EAAaC,SAAb,EAAwBC,cAAxB,EAAwCE,QAAxC,EAAkDD,UAAtD,EACER,IAAI,GAAI,IAAGF,IAAI,EAAEO,KAAN,EAAaC,SAAb,EAAwBC,cAAxB,EAAwCE,QAAxC,EAAkDD,UAAW,EAAxE;EACF,IAAIE,SAAS,GAAGnB,QAAQ,CAAC,MAAD,EAAS;IAC/BoB,QAAQ,EAAEb,IAAI,EAAEO,KAAN,EAAaM,QAAb,EAAuBA;EADF,CAAT,CAAxB;EAGA,IAAID,SAAJ,EAAeN,eAAe,GAAGM,SAAS,EAAEE,KAA7B;EAEf;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EAEE;;EACA,IAAId,IAAI,EAAEO,KAAN,EAAaQ,oBAAb,EAAmCA,oBAAnC,KAA4D,KAAhE,EAAuE;IACrEV,eAAe,GAAG;MAChBW,EAAE,EAAE,CAAC,aAAD,EAAgB,CAAhB,EAAmB,CAAnB;IADY,CAAlB;EAGD;;EACD,IAAIC,GAAG,GAAGnB,kBAAkB,CAACO,eAAD,EAAkB,uBAAlB,CAA5B,CApC6B,CAsC7B;;EACA,SAASa,QAAT,CAAkBC,IAAlB,EAAwBC,KAAxB,EAA+BC,SAA/B,EAA0C;IACxC,IAAIC,IAAI,GAAG,KAAX;IACA,OAAO,YAAY;MACjB,IAAI,CAACA,IAAL,EAAW;QACTH,IAAI,CAACE,SAAD,CAAJ;QACAC,IAAI,GAAG,IAAP;QACAC,UAAU,CAAC,YAAY;UACrBD,IAAI,GAAG,KAAP;QACD,CAFS,EAEPF,KAFO,CAAV;MAGD;IACF,CARD;EASD;;EACDI,MAAM,CAACC,gBAAP,CAAwB,QAAxB,EAAkCP,QAAQ,CAAClB,IAAI,EAAE0B,KAAN,EAAaC,YAAd,EAA4B,IAA5B,CAA1C;EAEA,oBACE;IACE,GAAG,EAAE3B,IAAI,EAAEO,KAAN,EAAaC,SAAb,EAAwBC,cAAxB,EAAwCmB,OAAxC,EAAiDC,EADxD;IAEE,SAAS,EAAC;EAFZ,gBAIE,oBAAC,gBAAD;IAAkB,GAAG,EAAEZ;EAAvB,gBACE;IAAK,EAAE,EAAC,uBAAR;IAAgC,SAAS,EAAC;EAA1C,gBACE;IACE,SAAS,EAAG,sCAAqCjB,IAAI,EAAEO,KAAN,EAAaM,QAAb,EAAuBA,QAAvB,EAAiCiB,GAAI;EADxF,gBAGE;IAAK,EAAE,EAAC;EAAR,EAHF,CADF,eAME;IACE,SAAS,EAAG,sCAAqC9B,IAAI,EAAEO,KAAN,EAAaM,QAAb,EAAuBA,QAAvB,EAAiCiB,GAAI;EADxF,GAGGxB,eAHH,CANF,CADF,CAJF,CADF;AAqBD;;AAED,SAASP,eAAT"}