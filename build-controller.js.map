{"version":3,"file":"build-controller.js","names":["React","renderToStaticMarkup","styled","Link","SvgShape","SvgPlay","SvgRewind","TractStackLogo","lispCallback","StyledWrapperDiv","InjectCssAnimation","lispLexer","ImpressionsCarousel","ImpressionsIcons","BuildController","data","viewportKey","next","prev","link","svgString","b64","dataUri","css","mask_css","react_fragment","effects_payload","controller_pane","controller_pane_minimized","id","shape","window","btoa","injectPayloadMinimize","payload","payload_ast","useHookEndPoint","injectPayloadExpand","prefersReducedMotion","in","animateController","animateControllerExpand","animateControllerMinimize","controller","impressions","activePanes"],"sources":["src/build-controller.js"],"sourcesContent":["import React from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport styled from \"styled-components\";\nimport { Link } from \"gatsby\";\nimport { SvgShape, SvgPlay, SvgRewind, TractStackLogo } from \"./shapes\";\nimport { lispCallback, StyledWrapperDiv, InjectCssAnimation } from \"./helpers\";\nimport { lispLexer } from \"./lexer\";\nimport { ImpressionsCarousel, ImpressionsIcons } from \"./impressions\";\n\nconst BuildController = (data) => {\n  let viewportKey = data?.viewportKey;\n  if (viewportKey === \"none\") return <></>;\n  let next,\n    prev,\n    link,\n    svgString,\n    b64,\n    dataUri,\n    css,\n    mask_css,\n    react_fragment,\n    effects_payload,\n    controller_pane,\n    controller_pane_minimized;\n  controller_pane = SvgShape(\"controller\", {\n    id: `svg-controller-${viewportKey}`,\n    viewportKey: viewportKey,\n  }).shape;\n  controller_pane_minimized = SvgShape(\"mini\", {\n    id: `svg-controller-mini-${viewportKey}`,\n    viewportKey: viewportKey,\n  }).shape;\n\n  svgString = renderToStaticMarkup(controller_pane_minimized);\n  b64 = window.btoa(svgString);\n  dataUri = `data:image/svg+xml;base64,${b64}`;\n  mask_css =\n    `#controller-container-minimized {-webkit-mask-image: url(\"${dataUri}\"); mask-image: url(\"${dataUri}\");` +\n    ` mask-repeat: no-repeat; -webkit-mask-size: 100% AUTO; mask-size: 100% AUTO; }`;\n\n  svgString = renderToStaticMarkup(controller_pane);\n  b64 = window.btoa(svgString);\n  dataUri = `data:image/svg+xml;base64,${b64}`;\n  mask_css =\n    `${mask_css} #controller-container-expanded {-webkit-mask-image: url(\"${dataUri}\"); mask-image: url(\"${dataUri}\");` +\n    ` mask-repeat: no-repeat; -webkit-mask-size: 100% AUTO; mask-size: 100% AUTO; }`;\n\n  function injectPayloadMinimize() {\n    let payload = \"(controller (minimize))\";\n    let payload_ast = lispLexer(payload);\n    lispCallback(payload_ast[0], \"controller\", data?.useHookEndPoint);\n  }\n  function injectPayloadExpand() {\n    let payload = \"(controller (expand))\";\n    let payload_ast = lispLexer(payload);\n    lispCallback(payload_ast[0], \"controller\", data?.useHookEndPoint);\n  }\n\n  // can we wrap this in animation?\n  if (data?.prefersReducedMotion?.prefersReducedMotion === false) {\n    effects_payload = {\n      in: [\"fadeInRight\", 0.65, 0],\n    };\n    let animateController = InjectCssAnimation(effects_payload, \"controller\");\n    effects_payload = {\n      in: [\"pulseExpand\", 2, 10],\n    };\n    let animateControllerExpand = InjectCssAnimation(\n      effects_payload,\n      \"controller-expand\"\n    );\n    let animateControllerMinimize = InjectCssAnimation(\n      effects_payload,\n      \"controller-minimize\"\n    );\n    css = `${animateController} ${animateControllerExpand} ${animateControllerMinimize}`;\n  }\n\n  css = `${css} ${mask_css}`;\n\n  return (\n    <>\n      <StyledWrapperDiv css={css} id=\"controller-container\">\n        <div\n          id=\"controller-container-expanded\"\n          className={`controller__container--${viewportKey}`}\n        >\n          <div\n            className=\"controller__container--minimize\"\n            onClick={() => injectPayloadMinimize()}\n            title=\"Minimize the Controller\"\n          >\n            <div>&lt;</div>\n          </div>\n          <div id=\"controller-carousel\">\n            <ImpressionsCarousel\n              payload={data?.controller?.payload?.impressions}\n              activePanes={data?.controller?.activePanes}\n              useHookEndPoint={data?.useHookEndPoint}\n              viewportKey={viewportKey}\n            />\n          </div>\n        </div>\n        <div\n          id=\"controller-container-minimized\"\n          className={`controller__container--${viewportKey}`}\n        >\n          <ImpressionsIcons\n            payload={data?.controller?.payload?.impressions}\n            activePanes={data?.controller?.activePanes}\n            useHookEndPoint={data?.useHookEndPoint}\n            viewportKey={viewportKey}\n          />\n          <div\n            className=\"controller__container--expand\"\n            onClick={() => injectPayloadExpand()}\n            title=\"Toggle Full Controller\"\n          >\n            <div>&gt;</div>\n          </div>\n        </div>\n      </StyledWrapperDiv>\n    </>\n  );\n};\n\nexport { BuildController };\n"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,oBAAT,QAAqC,kBAArC;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,SAASC,IAAT,QAAqB,QAArB;AACA,SAASC,QAAT,EAAmBC,OAAnB,EAA4BC,SAA5B,EAAuCC,cAAvC,QAA6D,UAA7D;AACA,SAASC,YAAT,EAAuBC,gBAAvB,EAAyCC,kBAAzC,QAAmE,WAAnE;AACA,SAASC,SAAT,QAA0B,SAA1B;AACA,SAASC,mBAAT,EAA8BC,gBAA9B,QAAsD,eAAtD;;AAEA,MAAMC,eAAe,GAAIC,IAAD,IAAU;EAChC,IAAIC,WAAW,GAAGD,IAAI,EAAEC,WAAxB;EACA,IAAIA,WAAW,KAAK,MAApB,EAA4B,oBAAO,yCAAP;EAC5B,IAAIC,IAAJ,EACEC,IADF,EAEEC,IAFF,EAGEC,SAHF,EAIEC,GAJF,EAKEC,OALF,EAMEC,GANF,EAOEC,QAPF,EAQEC,cARF,EASEC,eATF,EAUEC,eAVF,EAWEC,yBAXF;EAYAD,eAAe,GAAGvB,QAAQ,CAAC,YAAD,EAAe;IACvCyB,EAAE,EAAG,kBAAiBb,WAAY,EADK;IAEvCA,WAAW,EAAEA;EAF0B,CAAf,CAAR,CAGfc,KAHH;EAIAF,yBAAyB,GAAGxB,QAAQ,CAAC,MAAD,EAAS;IAC3CyB,EAAE,EAAG,uBAAsBb,WAAY,EADI;IAE3CA,WAAW,EAAEA;EAF8B,CAAT,CAAR,CAGzBc,KAHH;EAKAV,SAAS,GAAGnB,oBAAoB,CAAC2B,yBAAD,CAAhC;EACAP,GAAG,GAAGU,MAAM,CAACC,IAAP,CAAYZ,SAAZ,CAAN;EACAE,OAAO,GAAI,6BAA4BD,GAAI,EAA3C;EACAG,QAAQ,GACL,6DAA4DF,OAAQ,wBAAuBA,OAAQ,KAApG,GACC,gFAFH;EAIAF,SAAS,GAAGnB,oBAAoB,CAAC0B,eAAD,CAAhC;EACAN,GAAG,GAAGU,MAAM,CAACC,IAAP,CAAYZ,SAAZ,CAAN;EACAE,OAAO,GAAI,6BAA4BD,GAAI,EAA3C;EACAG,QAAQ,GACL,GAAEA,QAAS,6DAA4DF,OAAQ,wBAAuBA,OAAQ,KAA/G,GACC,gFAFH;;EAIA,SAASW,qBAAT,GAAiC;IAC/B,IAAIC,OAAO,GAAG,yBAAd;IACA,IAAIC,WAAW,GAAGxB,SAAS,CAACuB,OAAD,CAA3B;IACA1B,YAAY,CAAC2B,WAAW,CAAC,CAAD,CAAZ,EAAiB,YAAjB,EAA+BpB,IAAI,EAAEqB,eAArC,CAAZ;EACD;;EACD,SAASC,mBAAT,GAA+B;IAC7B,IAAIH,OAAO,GAAG,uBAAd;IACA,IAAIC,WAAW,GAAGxB,SAAS,CAACuB,OAAD,CAA3B;IACA1B,YAAY,CAAC2B,WAAW,CAAC,CAAD,CAAZ,EAAiB,YAAjB,EAA+BpB,IAAI,EAAEqB,eAArC,CAAZ;EACD,CA/C+B,CAiDhC;;;EACA,IAAIrB,IAAI,EAAEuB,oBAAN,EAA4BA,oBAA5B,KAAqD,KAAzD,EAAgE;IAC9DZ,eAAe,GAAG;MAChBa,EAAE,EAAE,CAAC,aAAD,EAAgB,IAAhB,EAAsB,CAAtB;IADY,CAAlB;IAGA,IAAIC,iBAAiB,GAAG9B,kBAAkB,CAACgB,eAAD,EAAkB,YAAlB,CAA1C;IACAA,eAAe,GAAG;MAChBa,EAAE,EAAE,CAAC,aAAD,EAAgB,CAAhB,EAAmB,EAAnB;IADY,CAAlB;IAGA,IAAIE,uBAAuB,GAAG/B,kBAAkB,CAC9CgB,eAD8C,EAE9C,mBAF8C,CAAhD;IAIA,IAAIgB,yBAAyB,GAAGhC,kBAAkB,CAChDgB,eADgD,EAEhD,qBAFgD,CAAlD;IAIAH,GAAG,GAAI,GAAEiB,iBAAkB,IAAGC,uBAAwB,IAAGC,yBAA0B,EAAnF;EACD;;EAEDnB,GAAG,GAAI,GAAEA,GAAI,IAAGC,QAAS,EAAzB;EAEA,oBACE,uDACE,oBAAC,gBAAD;IAAkB,GAAG,EAAED,GAAvB;IAA4B,EAAE,EAAC;EAA/B,gBACE;IACE,EAAE,EAAC,+BADL;IAEE,SAAS,EAAG,0BAAyBP,WAAY;EAFnD,gBAIE;IACE,SAAS,EAAC,iCADZ;IAEE,OAAO,EAAE,MAAMiB,qBAAqB,EAFtC;IAGE,KAAK,EAAC;EAHR,gBAKE,qCALF,CAJF,eAWE;IAAK,EAAE,EAAC;EAAR,gBACE,oBAAC,mBAAD;IACE,OAAO,EAAElB,IAAI,EAAE4B,UAAN,EAAkBT,OAAlB,EAA2BU,WADtC;IAEE,WAAW,EAAE7B,IAAI,EAAE4B,UAAN,EAAkBE,WAFjC;IAGE,eAAe,EAAE9B,IAAI,EAAEqB,eAHzB;IAIE,WAAW,EAAEpB;EAJf,EADF,CAXF,CADF,eAqBE;IACE,EAAE,EAAC,gCADL;IAEE,SAAS,EAAG,0BAAyBA,WAAY;EAFnD,gBAIE,oBAAC,gBAAD;IACE,OAAO,EAAED,IAAI,EAAE4B,UAAN,EAAkBT,OAAlB,EAA2BU,WADtC;IAEE,WAAW,EAAE7B,IAAI,EAAE4B,UAAN,EAAkBE,WAFjC;IAGE,eAAe,EAAE9B,IAAI,EAAEqB,eAHzB;IAIE,WAAW,EAAEpB;EAJf,EAJF,eAUE;IACE,SAAS,EAAC,+BADZ;IAEE,OAAO,EAAE,MAAMqB,mBAAmB,EAFpC;IAGE,KAAK,EAAC;EAHR,gBAKE,qCALF,CAVF,CArBF,CADF,CADF;AA4CD,CAnHD;;AAqHA,SAASvB,eAAT"}