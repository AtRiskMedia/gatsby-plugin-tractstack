{"version":3,"file":"compose-panes.js","names":["React","useRef","renderToStaticMarkup","useInView","InjectPaneFragment","InjectSvgModal","StyledWrapperDiv","InjectCssAnimation","HasImageMask","HasPaneFragmentType","thisViewportValue","viewportWidth","lispCallback","lispLexer","SvgModals","SvgShape","ComposePanes","data","viewportKey","composedPanes","fragments","relationships","field_panes","map","pane","i","hasAccessibleController","prefersReducedMotion","payload","accessibleController","hasOwnProperty","id","useHookEndPoint","impressionsData","impression","this_id","icon","headline","payload_ast","actionsLisp","injectPayload","push","ComposedPane","observe","inView","onEnter","onLeave","pane_css","effects","background_colour","field_pane_fragments","filter","e","internal","type","this_selector","shape","pane_height_ratio","mobile","field_height_ratio_mobile","tablet","field_height_ratio_tablet","desktop","field_height_ratio_desktop","pane_height","pane_height_css","height_offset","field_height_offset_mobile","field_height_offset_tablet","field_height_offset_desktop","length","field_background_colour","composedPaneFragments","field_hidden_viewports","replace","split","indexOf","sort","a","b","field_zindex","pane_fragment","index","react_fragment","tractStackFragment","this_payload","tempValue","imageData","field_text_shape_outside_mobile","field_text_shape_outside_tablet","field_text_shape_outside_desktop","field_image_mask_shape_mobile","field_image_mask_shape_tablet","field_image_mask_shape_desktop","this_options","imageMaskShapeSelector","svgString","b64","window","btoa","dataUri","childPaneFragment","childMarkdownRemark","htmlAst","children","value","field_modal","textShapeOutside","maskData","left_mask","right_mask","options","modal","this_modal_payload","this_fragment","this_shape","this_css","this_viewport","Object","keys","mode","cut","width","height","z_index","css","field_css_styles_parent_mobile","field_css_styles_parent_tablet","field_css_styles_parent_desktop","this_width","padding_left","padding_top","thisClass","codeHooks","field_shape_mobile","field_shape_tablet","field_shape_desktop","shapeData","videoData","url","field_cdn_url","alt_text","field_alt_text","field_svg_file","localFile","publicURL","description","buttons","buttonData","key","paneFragment","field_image","this_image","this_imageData","filename","backgroundPosition","field_background_position","css_child","field_css_styles_mobile","field_css_styles_tablet","field_css_styles_desktop","css_parent","viewport","device","parent","child","modalData","this_pane_fragment_type","fragment","console","log","renderedPaneFragment","this_effects_payload","in","function","speed","delay","this_effects_css"],"sources":["src/compose-panes.js"],"sourcesContent":["import React, { useRef } from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport { useInView } from \"react-cool-inview\";\nimport {\n  InjectPaneFragment,\n  InjectSvgModal,\n  StyledWrapperDiv,\n  InjectCssAnimation,\n  HasImageMask,\n  HasPaneFragmentType,\n  thisViewportValue,\n  viewportWidth,\n  lispCallback,\n} from \"./helpers\";\nimport { lispLexer } from \"./lexer\";\nimport { SvgModals, SvgShape } from \"./shapes\";\n\nconst ComposePanes = (data) => {\n  // if viewport is not yet defined, return empty fragment\n  if (data?.viewportKey === \"none\") return <></>;\n\n  // loop through the panes in view and render each pane fragment\n  const composedPanes = data?.fragments?.relationships?.field_panes?.map(\n    (pane, i) => {\n      let hasAccessibleController =\n        data?.prefersReducedMotion?.prefersReducedMotion === true &&\n        data?.payload?.payload?.accessibleController?.hasOwnProperty(pane?.id);\n      if (!hasAccessibleController)\n        return (\n          <ComposedPane\n            key={i}\n            data={{\n              pane: pane,\n              viewportKey: data?.viewportKey,\n              prefersReducedMotion: data?.prefersReducedMotion,\n              payload: data?.payload,\n              useHookEndPoint: data?.useHookEndPoint,\n            }}\n          />\n        );\n\n      let accessibleController = [],\n        impressionsData = data?.payload?.payload?.accessibleController[pane.id];\n      for (const impression in impressionsData) {\n        let this_id = `accessible-controller-li-${pane.id}-${impressionsData[impression].icon}`;\n        let headline = impressionsData[impression].headline;\n        let payload_ast = lispLexer(impressionsData[impression].actionsLisp);\n        function injectPayload() {\n          lispCallback(payload_ast[0], \"button\", data?.useHookEndPoint);\n        }\n        accessibleController.push(\n          <li key={this_id}>\n            {headline} <button onClick={() => injectPayload()}>Read</button>\n          </li>\n        );\n      }\n      return (\n        <React.Fragment key={i}>\n          <ComposedPane\n            data={{\n              pane: pane,\n              viewportKey: data?.viewportKey,\n              prefersReducedMotion: data?.prefersReducedMotion,\n              payload: data?.payload,\n              useHookEndPoint: data?.useHookEndPoint,\n            }}\n          />\n          <div className=\"accessible-controller\">\n            <ul>{accessibleController}</ul>\n          </div>\n        </React.Fragment>\n      );\n    }\n  );\n  // this is the storyFragment\n  if (typeof composedPanes === \"undefined\") return <></>;\n  return composedPanes;\n};\n\nconst ComposedPane = (data) => {\n  // set key variables\n  const pane = data?.data?.pane;\n  const viewportKey = data?.data?.viewportKey;\n  const prefersReducedMotion = data?.data?.prefersReducedMotion;\n  const payload = data?.data?.payload?.payload;\n  const useHookEndPoint = data?.data?.useHookEndPoint;\n  // useInView hook\n  const { observe, inView } = useInView({\n    onEnter: ({}) => {\n      useHookEndPoint(\"hookPaneVisible\", pane?.id);\n    },\n    onLeave: ({}) => {\n      useHookEndPoint(\"hookPaneHidden\", pane?.id);\n    },\n  });\n\n  let pane_css = \"\",\n    effects = {};\n  let background_colour = pane?.relationships?.field_pane_fragments.filter(\n    (e) => e?.internal?.type === \"paragraph__background_colour\"\n  );\n  let this_selector, shape;\n  let pane_height_ratio = thisViewportValue(viewportKey, {\n    mobile: pane?.field_height_ratio_mobile,\n    tablet: pane?.field_height_ratio_tablet,\n    desktop: pane?.field_height_ratio_desktop,\n  });\n  let pane_height = thisViewportValue(viewportKey, {\n    mobile: (600 * pane_height_ratio) / 100,\n    tablet: (1080 * pane_height_ratio) / 100,\n    desktop: (1920 * pane_height_ratio) / 100,\n  });\n  let pane_height_css = `calc((100vw - (var(--offset) * 1px)) * ${pane_height_ratio} / 100)`;\n  let height_offset = thisViewportValue(viewportKey, {\n    mobile: `calc((100vw - (var(--offset) * 1px)) / 600 * ${pane?.field_height_offset_mobile})`,\n    tablet: `calc((100vw - (var(--offset) * 1px)) / 1080 * ${pane?.field_height_offset_tablet})`,\n    desktop: `calc((100vw - (var(--offset) * 1px)) / 1920 * ${pane?.field_height_offset_desktop})`,\n  });\n\n  // prepare css for pane\n  pane_css = `${pane_css} height: ${pane_height_css}; margin-bottom: ${height_offset};`;\n  if (background_colour.length)\n    pane_css = `${pane_css} background-color: ${background_colour[0].field_background_colour};`;\n\n  // now compose the paneFragments for this pane\n  let composedPaneFragments = [];\n  pane?.relationships?.field_pane_fragments\n    // skip if current viewport is listed in field_hidden_viewports\n    .filter(\n      (e) =>\n        typeof e?.field_hidden_viewports === \"string\" &&\n        e?.field_hidden_viewports\n          .replace(/\\s+/g, \"\")\n          .split(\",\")\n          .indexOf(viewportKey) == -1\n    )\n    // already processed background_colour\n    .filter((e) => e?.internal?.type !== \"paragraph__background_colour\")\n    // sort by zIndex ***important\n    .sort((a, b) => (a?.field_zindex > b?.field_zindex ? 1 : -1))\n    .map((pane_fragment, index) => {\n      let react_fragment,\n        tractStackFragment,\n        this_payload = {},\n        tempValue,\n        shape;\n      this_payload.imageData = [];\n\n      // check for textShapeOutside\n      shape = thisViewportValue(viewportKey, {\n        mobile: pane_fragment?.field_text_shape_outside_mobile,\n        tablet: pane_fragment?.field_text_shape_outside_tablet,\n        desktop: pane_fragment?.field_text_shape_outside_desktop,\n      });\n\n      // check for imageMasks\n      shape = thisViewportValue(viewportKey, {\n        mobile: pane_fragment?.field_image_mask_shape_mobile,\n        tablet: pane_fragment?.field_image_mask_shape_tablet,\n        desktop: pane_fragment?.field_image_mask_shape_desktop,\n      });\n      if (typeof shape === \"string\" && shape !== \"none\") {\n        let this_options = {\n          viewportKey: viewportKey,\n          pane_height: pane_height,\n          id: `${pane_fragment?.id}-${viewportKey}`,\n        };\n        let tempValue = SvgShape(shape, this_options);\n        if (tempValue) shape = tempValue.shape;\n        let imageMaskShapeSelector =\n          HasImageMask[pane_fragment?.internal?.type];\n        if (imageMaskShapeSelector) {\n          let svgString = renderToStaticMarkup(shape);\n          let b64 = window.btoa(svgString);\n          let dataUri = `data:image/svg+xml;base64,${b64}`;\n          pane_css =\n            `${pane_css} ${imageMaskShapeSelector} {-webkit-mask-image: url(\"${dataUri}\"); mask-image: url(\"${dataUri}\");` +\n            ` mask-repeat: no-repeat; -webkit-mask-size: 100% AUTO; mask-size: 100% AUTO; }`;\n        }\n      }\n\n      // pre-pass paneFragment based on type\n      switch (pane_fragment?.internal?.type) {\n        case \"paragraph__markdown\":\n          // prepare any markdown for this paneFragment\n          if (pane_fragment?.childPaneFragment?.childMarkdownRemark?.htmlAst) {\n            this_payload.children =\n              pane_fragment?.childPaneFragment?.childMarkdownRemark?.htmlAst;\n            this_payload.children.children =\n              pane_fragment?.childPaneFragment?.childMarkdownRemark?.htmlAst?.children?.filter(\n                (e) => !(e.type === \"text\" && e.value === \"\\n\")\n              );\n          }\n          shape = thisViewportValue(viewportKey, {\n            mobile: pane_fragment?.field_text_shape_outside_mobile,\n            tablet: pane_fragment?.field_text_shape_outside_tablet,\n            desktop: pane_fragment?.field_text_shape_outside_desktop,\n          });\n          if (shape && !pane_fragment?.field_modal) {\n            // regular markdown paragraph; add shape outside if any\n            if (typeof shape === \"string\" && shape !== \"none\") {\n              let this_options = {\n                textShapeOutside: true,\n                viewportKey: viewportKey,\n                pane_height: pane_height,\n                id: `${pane_fragment?.id}-${viewportKey}`,\n              };\n              tempValue = SvgShape(shape, this_options);\n              if (tempValue)\n                this_payload.maskData = {\n                  textShapeOutside: tempValue,\n                };\n              pane_css =\n                `${pane_css} #svg__${tempValue?.id}--shape-outside-left {float:left;shape-outside:url(${tempValue?.left_mask})} ` +\n                `#svg__${tempValue?.id}--shape-outside-right {float:right;shape-outside:url(${tempValue?.right_mask})}`;\n            }\n          } else if (shape && pane_fragment?.field_modal) {\n            // this is a modal\n            let options =\n                payload?.modal &&\n                payload?.modal[pane?.id] &&\n                payload?.modal[pane?.id][pane_fragment?.id] &&\n                payload?.modal[pane?.id][pane_fragment?.id][viewportKey],\n              this_modal_payload = {},\n              this_fragment,\n              this_shape,\n              this_css,\n              this_viewport;\n            if (options && Object.keys(options).length !== 0) {\n              this_modal_payload = {\n                id: `${pane_fragment?.id}-${viewportKey}`,\n                mode: \"modal\",\n                textShapeOutside: true,\n                viewportKey: viewportKey,\n                cut: SvgModals[shape][\"cut\"],\n                width: SvgModals[shape][\"viewBox\"][0],\n                height: SvgModals[shape][\"viewBox\"][1],\n                pane_height: pane_height,\n                z_index: pane_fragment?.field_zindex,\n                ...options,\n              };\n              this_shape = SvgShape(shape, this_modal_payload);\n              // generate react fragment\n              tempValue = InjectSvgModal(this_shape?.shape, this_modal_payload);\n              this_fragment = tempValue?.modal;\n              if (tempValue?.css && typeof tempValue?.css === \"string\") {\n                pane_css = `${pane_css} #c-${tempValue?.id}-container { ${tempValue?.css} }`;\n              }\n              this_modal_payload.shape = this_shape;\n              this_css = thisViewportValue(viewportKey, {\n                mobile: pane_fragment?.field_css_styles_parent_mobile,\n                tablet: pane_fragment?.field_css_styles_parent_tablet,\n                desktop: pane_fragment?.field_css_styles_parent_desktop,\n              });\n              let this_width = viewportWidth[viewportKey];\n              pane_css =\n                `${pane_css} ${this_css} ` +\n                `#fragment-${pane_fragment?.id} svg.svg-shape-outside-left { ` +\n                `z-index: ${pane_fragment?.z_index - 1};` +\n                `width: calc((100vw - (var(--offset) * 1px)) / ${this_width} * ${\n                  this_modal_payload?.padding_left + this_modal_payload?.cut\n                }); ` +\n                `} ` +\n                `#fragment-${pane_fragment?.id} svg.svg-shape-outside-right { ` +\n                `z-index: ${pane_fragment?.z_index - 1};` +\n                `width: calc((100vw - (var(--offset) * 1px)) / ${this_width} * ${\n                  this_width -\n                  this_modal_payload?.width +\n                  this_modal_payload?.cut -\n                  this_modal_payload?.padding_left\n                }); ` +\n                `} ` +\n                `#${pane_fragment?.id}-svg-modal svg { ` +\n                `z-index: ${pane_fragment?.z_index - 1}; ` +\n                `width: calc((100vw - (var(--offset) * 1px)) / ${this_width} * ${this_modal_payload?.width}); ` +\n                `margin-left: calc((100vw - (var(--offset) * 1px)) / ${this_width} * ${this_modal_payload?.padding_left}); ` +\n                `margin-top: calc((100vw - (var(--offset) * 1px)) / ${this_width} * ${this_modal_payload?.padding_top}); ` +\n                `}`;\n            }\n            this_payload.maskData = { textShapeOutside: this_shape };\n            pane_css =\n              `${pane_css} #svg__${this_shape?.id}--shape-outside-left {float:left;shape-outside:url(${this_shape?.left_mask})} ` +\n              `#svg__${this_shape?.id}--shape-outside-right {float:right;shape-outside:url(${this_shape?.right_mask})}`;\n            let thisClass = `paneFragment paneFragment__view paneFragment__view--${viewportKey}`;\n\n            // add modal shape to stack\n            composedPaneFragments.push(\n              <div\n                className={thisClass}\n                key={`modal-outer-${pane_fragment?.id}`}\n              >\n                <div\n                  id={`modal-${pane_fragment?.id}`}\n                  className={\n                    inView ? \"paneFragment visible\" : \"paneFragment hidden\"\n                  }\n                  key={`modal-${pane_fragment?.id}`}\n                >\n                  {this_fragment}\n                </div>\n              </div>\n            );\n          }\n          break;\n\n        case \"paragraph__background_pane\":\n          if (\n            payload?.codeHooks?.hasOwnProperty(pane?.id) &&\n            payload?.codeHooks[pane?.id]?.hasOwnProperty(pane_fragment?.id)\n          )\n            this_payload.codeHooks =\n              payload.codeHooks[pane.id][pane_fragment.id];\n          shape = thisViewportValue(viewportKey, {\n            mobile: pane_fragment?.field_shape_mobile,\n            tablet: pane_fragment?.field_shape_tablet,\n            desktop: pane_fragment?.field_shape_desktop,\n          });\n          let this_options = {\n            viewportKey: viewportKey,\n            pane_height: pane_height,\n            id: `${pane_fragment?.id}-${viewportKey}`,\n          };\n          if (typeof shape === \"string\" && shape !== \"none\")\n            tempValue = SvgShape(shape, this_options);\n          if (tempValue) this_payload.shapeData = tempValue.shape;\n          break;\n\n        case \"paragraph__background_video\":\n          if (prefersReducedMotion?.prefersReducedMotion === false) {\n            this_payload.videoData = {\n              url: pane_fragment?.field_cdn_url,\n              alt_text: pane_fragment?.field_alt_text,\n            };\n          }\n          break;\n\n        case \"paragraph__svg\":\n          this_payload.imageData = [\n            {\n              url: pane_fragment?.relationships?.field_svg_file?.localFile\n                ?.publicURL,\n              alt_text: pane_fragment?.field_svg_file?.description,\n            },\n          ];\n          break;\n      }\n\n      // extract buttonData (if any)\n      if (\n        payload?.buttons &&\n        payload?.buttons[pane?.id] &&\n        payload?.buttons[pane?.id][pane_fragment?.id]\n      )\n        this_payload.buttonData = payload?.buttons[pane?.id][pane_fragment?.id];\n\n      // extract animation effects (if any)\n      if (\n        payload?.effects &&\n        payload?.effects[pane?.id] &&\n        payload?.effects[pane?.id][pane_fragment?.id]\n      )\n        tempValue = payload?.effects[pane?.id][pane_fragment?.id];\n      if (tempValue && Object.keys(tempValue).length) {\n        for (const key in tempValue) {\n          // store animation\n          effects[`fragment-${pane_fragment?.id}`] = {\n            pane: pane?.id,\n            paneFragment: `fragment-${pane_fragment?.id}`,\n            ...tempValue[key],\n          };\n          // store copy of the animation for modal (if any)\n          if (\n            pane_fragment?.internal?.type === \"paragraph__modal\" ||\n            pane_fragment?.field_modal\n          ) {\n            effects[`modal-${pane_fragment?.id}`] = { ...tempValue[key] };\n            effects[`modal-${pane_fragment?.id}`][\n              \"paneFragment\"\n            ] = `modal-${pane_fragment?.id}`;\n          }\n        }\n      }\n\n      // prepare any images from this paneFragment\n      pane_fragment?.relationships?.field_image?.map((e) => {\n        let this_image = thisViewportValue(viewportKey, {\n          mobile: e?.mobile,\n          tablet: e?.tablet,\n          desktop: e?.desktop,\n        });\n        if (this_image) {\n          let this_imageData = {\n            id: e?.id,\n            filename: e?.filename,\n            data: this_image,\n            backgroundPosition:\n              pane_fragment?.field_background_position || null,\n          };\n          if (typeof pane_fragment?.field_alt_text === \"string\")\n            this_imageData.alt_text = pane_fragment?.field_alt_text;\n          this_payload.imageData.push(this_imageData);\n        }\n      });\n      // select css for viewport\n      this_payload.css_child = thisViewportValue(viewportKey, {\n        mobile: pane_fragment?.field_css_styles_mobile || \"\",\n        tablet: pane_fragment?.field_css_styles_tablet || \"\",\n        desktop: pane_fragment?.field_css_styles_desktop || \"\",\n      });\n      this_payload.css_parent = thisViewportValue(viewportKey, {\n        mobile: pane_fragment?.field_css_styles_parent_mobile || \"\",\n        tablet: pane_fragment?.field_css_styles_parent_tablet || \"\",\n        desktop: pane_fragment?.field_css_styles_parent_desktop || \"\",\n      });\n      // prepare structured data for this paneFragment\n      tractStackFragment = {\n        id: pane_fragment?.id,\n        mode: pane_fragment?.internal?.type,\n        pane_height_css: pane_height_css,\n        viewport: {\n          device: viewportKey,\n          width: viewportWidth[viewportKey],\n        },\n        z_index: pane_fragment?.field_zindex,\n        children: this_payload?.children || {},\n        css: {\n          parent: this_payload?.css_parent || \"\",\n          child: this_payload?.css_child || \"\",\n        },\n        payload: {\n          imageData: this_payload?.imageData || [],\n          maskData: this_payload?.maskData || {},\n          useHookEndPoint: useHookEndPoint || {},\n          videoData: this_payload?.videoData || {},\n          shapeData: this_payload?.shapeData || {},\n          modalData: this_payload?.modalData || {},\n          buttonData: this_payload?.buttonData || {},\n          codeHooks: this_payload?.codeHooks || {},\n        },\n      };\n\n      let this_pane_fragment_type =\n        HasPaneFragmentType[tractStackFragment?.mode];\n      if (this_pane_fragment_type) {\n        tempValue = InjectPaneFragment(\n          tractStackFragment,\n          (this_payload?.codeHooks && \"CodeHook\") || this_pane_fragment_type\n        );\n        if (tempValue?.css && typeof tempValue?.css === \"string\") {\n          pane_css = `${pane_css} #c-${tempValue?.id}-container { ${tempValue?.css} }`;\n          pane_css = `${pane_css} #c-${tempValue?.id}-container-section { height:100%; }`;\n        }\n        react_fragment = tempValue?.fragment;\n      } else\n        console.log(\"ERROR in compose-panes.js: pane fragment type not found.\");\n\n      let thisClass = `paneFragment paneFragment__view paneFragment__view--${viewportKey}`;\n      let renderedPaneFragment;\n\n      // add the composed pane fragment\n      composedPaneFragments.push(\n        <div className={thisClass} key={`fragment-outer-${pane_fragment?.id}`}>\n          <div\n            id={`fragment-${pane_fragment?.id}`}\n            className={inView ? \"paneFragment visible\" : \"paneFragment hidden\"}\n            key={`fragment-${pane_fragment?.id}`}\n          >\n            {react_fragment}\n          </div>\n        </div>\n      );\n    });\n  // skip if empty pane\n  if (composedPaneFragments.length === 0) return;\n\n  // may we wrap this in animation?\n  if (prefersReducedMotion?.prefersReducedMotion === false) {\n    for (const key in effects) {\n      let this_effects_payload = {\n        in: [effects[key]?.function, effects[key]?.speed, effects[key]?.delay],\n      };\n      let this_effects_css = InjectCssAnimation(\n        this_effects_payload,\n        effects[key]?.paneFragment\n      );\n      pane_css = `${pane_css} ${this_effects_css} `;\n    }\n  }\n\n  return (\n    <section key={`pane-${pane?.id}`}>\n      <StyledWrapperDiv\n        ref={observe}\n        className={`pane pane__view pane__view--${viewportKey}`}\n        css={pane_css}\n        id={pane?.id}\n      >\n        {composedPaneFragments}\n      </StyledWrapperDiv>\n    </section>\n  );\n};\n\nexport { ComposePanes };\n"],"mappings":"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"}