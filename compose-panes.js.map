{"version":3,"file":"compose-panes.js","names":["React","useRef","renderToStaticMarkup","useInView","InjectPaneFragment","InjectSvgModal","StyledWrapperDiv","InjectCssAnimation","HasImageMask","HasPaneFragmentType","thisViewportValue","SvgModals","SvgShape","ComposedPane","data","pane","state","hooks","pane_css","effects","background_colour","relationships","field_pane_fragments","filter","e","internal","type","this_selector","shape","pane_height_ratio","viewport","key","mobile","field_height_ratio_mobile","tablet","field_height_ratio_tablet","desktop","field_height_ratio_desktop","pane_height","pane_height_css","height_offset","field_height_offset_mobile","field_height_offset_tablet","field_height_offset_desktop","length","field_background_colour","composedPaneFragments","field_hidden_viewports","replace","split","indexOf","sort","a","b","field_zindex","map","pane_fragment","index","react_fragment","tractStackFragment","payload","tempValue","imageData","field_image_mask_shape_mobile","field_image_mask_shape_tablet","field_image_mask_shape_desktop","this_options","imageMaskShapeSelector","svgString","b64","window","btoa","dataUri","childPaneFragment","childMarkdownRemark","htmlAst","children","value","field_text_shape_outside_mobile","field_text_shape_outside_tablet","field_text_shape_outside_desktop","field_modal","textShapeOutside","maskData","id","left_mask","right_mask","options","controller","render","this_payload","this_fragment","this_shape","this_css","this_viewport","Object","keys","mode","cut","width","height","z_index","field_css_styles_parent_mobile","field_css_styles_parent_tablet","field_css_styles_parent_desktop","padding_left","padding_top","thisClass","observe","inView","unobserveOnEnter","rootMargin","renderedModal","push","field_shape_mobile","field_shape_tablet","field_shape_desktop","shapeData","videoData","url","field_cdn_url","alt_text","field_alt_text","field_svg_file","localFile","publicURL","description","buttons","buttonData","structuredClone","field_image","this_image","this_imageData","filename","backgroundPosition","field_background_position","css_child","field_css_styles_mobile","field_css_styles_tablet","field_css_styles_desktop","css_parent","device","css","parent","child","hooksData","modalData","this_pane_fragment_type","console","log","renderedPaneFragment","prefersReducedMotion","this_effects_payload","in","function","speed","delay","this_effects_css","paneFragment","threshold","onEnter","hookPaneVisible","onLeave","hookPaneHidden","ComposePanes","composedPanes","fragments","field_panes","i"],"sources":["src/compose-panes.js"],"sourcesContent":["import React, { useRef } from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport { useInView } from \"react-cool-inview\";\nimport {\n  InjectPaneFragment,\n  InjectSvgModal,\n  StyledWrapperDiv,\n  InjectCssAnimation,\n  HasImageMask,\n  HasPaneFragmentType,\n  thisViewportValue,\n} from \"./helpers\";\nimport { SvgModals, SvgShape } from \"./shapes\";\n\nconst ComposedPane = (data) => {\n  const pane = data?.data?.pane;\n  const state = data?.data?.state;\n  const hooks = data?.data?.hooks;\n  let pane_css = \"\",\n    effects = [];\n\n  // set key variables\n  let background_colour = pane?.relationships?.field_pane_fragments.filter(\n    (e) => e?.internal?.type === \"paragraph__background_colour\"\n  );\n  let this_selector, shape;\n  let pane_height_ratio = thisViewportValue(state?.viewport?.viewport?.key, {\n    mobile: pane?.field_height_ratio_mobile,\n    tablet: pane?.field_height_ratio_tablet,\n    desktop: pane?.field_height_ratio_desktop,\n  });\n  let pane_height = thisViewportValue(state?.viewport?.viewport?.key, {\n    mobile: (600 * pane_height_ratio) / 100,\n    tablet: (1080 * pane_height_ratio) / 100,\n    desktop: (1920 * pane_height_ratio) / 100,\n  });\n  let pane_height_css = `calc((100vw - (var(--offset) * 1px)) * ${pane_height_ratio} / 100)`;\n  let height_offset = thisViewportValue(state?.viewport?.viewport?.key, {\n    mobile: `calc((100vw - (var(--offset) * 1px)) / 600 * ${pane?.field_height_offset_mobile})`,\n    tablet: `calc((100vw - (var(--offset) * 1px)) / 1080 * ${pane?.field_height_offset_tablet})`,\n    desktop: `calc((100vw - (var(--offset) * 1px)) / 1920 * ${pane?.field_height_offset_desktop})`,\n  });\n\n  // prepare css for pane\n  pane_css = `${pane_css} height: ${pane_height_css}; margin-bottom: ${height_offset};`;\n  if (background_colour.length)\n    pane_css = `${pane_css} background-color: ${background_colour[0].field_background_colour};`;\n\n  // now compose the paneFragments for this pane\n  let composedPaneFragments = [];\n  pane?.relationships?.field_pane_fragments\n    // skip if current viewport is listed in field_hidden_viewports\n    .filter(\n      (e) =>\n        typeof e?.field_hidden_viewports === \"string\" &&\n        e?.field_hidden_viewports\n          .replace(/\\s+/g, \"\")\n          .split(\",\")\n          .indexOf(state?.viewport?.viewport?.key) == -1\n    )\n    // already processed background_colour\n    .filter((e) => e?.internal?.type !== \"paragraph__background_colour\")\n    // sort by zIndex ***important\n    .sort((a, b) => (a?.field_zindex > b?.field_zindex ? 1 : -1))\n    .map((pane_fragment, index) => {\n      let react_fragment,\n        tractStackFragment,\n        payload = {},\n        tempValue,\n        shape;\n      payload.imageData = [];\n\n      // check for imageMasks\n      shape = thisViewportValue(state?.viewport?.viewport?.key, {\n        mobile: pane_fragment?.field_image_mask_shape_mobile,\n        tablet: pane_fragment?.field_image_mask_shape_tablet,\n        desktop: pane_fragment?.field_image_mask_shape_desktop,\n      });\n      if (typeof shape === \"string\" && shape !== \"none\") {\n        let this_options = {\n          viewport: state?.viewport?.viewport,\n          pane_height: pane_height,\n        };\n        let tempValue = SvgShape(shape, this_options);\n        if (tempValue) shape = tempValue.shape;\n        let imageMaskShapeSelector =\n          HasImageMask[pane_fragment?.internal?.type];\n        if (imageMaskShapeSelector) {\n          let svgString = renderToStaticMarkup(shape);\n          let b64 = window.btoa(svgString);\n          let dataUri = `data:image/svg+xml;base64,${b64}`;\n          pane_css =\n            `${pane_css} ${imageMaskShapeSelector} {-webkit-mask-image: url(\"${dataUri}\"); mask-image: url(\"${dataUri}\");` +\n            ` mask-repeat: no-repeat; -webkit-mask-size: 100% AUTO; mask-size: 100% AUTO; }`;\n        }\n      }\n\n      // pre-pass paneFragment based on type\n      switch (pane_fragment?.internal?.type) {\n        case \"paragraph__markdown\":\n          // prepare any markdown for this paneFragment\n          if (pane_fragment?.childPaneFragment?.childMarkdownRemark?.htmlAst) {\n            payload.children =\n              pane_fragment?.childPaneFragment?.childMarkdownRemark?.htmlAst;\n            payload.children.children =\n              pane_fragment?.childPaneFragment?.childMarkdownRemark?.htmlAst?.children?.filter(\n                (e) => !(e.type === \"text\" && e.value === \"\\n\")\n              );\n          }\n          shape = thisViewportValue(state?.viewport?.viewport?.key, {\n            mobile: pane_fragment?.field_text_shape_outside_mobile,\n            tablet: pane_fragment?.field_text_shape_outside_tablet,\n            desktop: pane_fragment?.field_text_shape_outside_desktop,\n          });\n          if (shape && !pane_fragment?.field_modal) {\n            // regular markdown paragraph; add shape outside if any\n            if (shape && shape !== \"none\") {\n              let this_options = {\n                textShapeOutside: true,\n                viewport: state?.viewport?.viewport,\n                pane_height: pane_height,\n              };\n              tempValue = SvgShape(shape, this_options);\n              if (tempValue)\n                payload.maskData = {\n                  textShapeOutside: tempValue,\n                };\n              pane_css =\n                `${pane_css} #svg__${tempValue?.id}--shape-outside-left {float:left;shape-outside:url(${tempValue?.left_mask})} ` +\n                `#svg__${tempValue?.id}--shape-outside-right {float:right;shape-outside:url(${tempValue?.right_mask})}`;\n            }\n          } else if (shape && pane_fragment?.field_modal) {\n            // this is a modal\n            let options =\n                state?.controller?.payload?.render[pane?.id][pane_fragment?.id][\n                  state?.viewport?.viewport?.key\n                ],\n              this_payload = {},\n              this_fragment,\n              this_shape,\n              this_css,\n              this_viewport;\n            if (Object.keys(options).length !== 0) {\n              this_payload = {\n                id: pane_fragment?.id,\n                mode: \"modal\",\n                textShapeOutside: true,\n                viewport: state?.viewport?.viewport,\n                cut: SvgModals[shape][\"cut\"],\n                width: SvgModals[shape][\"viewBox\"][0],\n                height: SvgModals[shape][\"viewBox\"][1],\n                pane_height: pane_height,\n                z_index: pane_fragment?.field_zindex,\n                ...options,\n              };\n              this_shape = SvgShape(shape, this_payload);\n              // generate react fragment\n              this_fragment = InjectSvgModal(this_shape?.shape, this_payload);\n              this_payload.shape = this_shape;\n              this_css = thisViewportValue(state?.viewport?.viewport?.key, {\n                mobile: pane_fragment?.field_css_styles_parent_mobile,\n                tablet: pane_fragment?.field_css_styles_parent_tablet,\n                desktop: pane_fragment?.field_css_styles_parent_desktop,\n              });\n              pane_css =\n                `${pane_css} ${this_css} ` +\n                `#fragment-${pane_fragment?.id} svg.svg-shape-outside-left { ` +\n                `z-index: ${pane_fragment?.z_index - 1};` +\n                `width: calc((100vw - (var(--offset) * 1px)) / ${\n                  this_payload?.viewport?.width\n                } * ${this_payload?.padding_left + this_payload?.cut}); ` +\n                `} ` +\n                `#fragment-${pane_fragment?.id} svg.svg-shape-outside-right { ` +\n                `z-index: ${pane_fragment?.z_index - 1};` +\n                `width: calc((100vw - (var(--offset) * 1px)) / ${\n                  this_payload?.viewport?.width\n                } * ${\n                  this_payload?.viewport?.width -\n                  this_payload?.width +\n                  this_payload?.cut -\n                  this_payload?.padding_left\n                }); ` +\n                `} ` +\n                `#${pane_fragment?.id}-svg-modal svg { ` +\n                `z-index: ${pane_fragment?.z_index - 1}; ` +\n                `width: calc((100vw - (var(--offset) * 1px)) / ${this_payload?.viewport?.width} * ${this_payload?.width}); ` +\n                `margin-left: calc((100vw - (var(--offset) * 1px)) / ${this_payload?.viewport?.width} * ${this_payload?.padding_left}); ` +\n                `margin-top: calc((100vw - (var(--offset) * 1px)) / ${this_payload?.viewport?.width} * ${this_payload?.padding_top}); ` +\n                `}`;\n            }\n            payload.maskData = { textShapeOutside: this_shape };\n            pane_css =\n              `${pane_css} #svg__${this_shape?.id}--shape-outside-left {float:left;shape-outside:url(${this_shape?.left_mask})} ` +\n              `#svg__${this_shape?.id}--shape-outside-right {float:right;shape-outside:url(${this_shape?.right_mask})}`;\n            let thisClass = `paneFragment paneFragment__view paneFragment__view--${state?.viewport?.viewport?.key}`;\n\n            // add inView observer to trigger animation\n            const { observe, inView } = useInView({\n              unobserveOnEnter: true,\n              rootMargin: \"-100px 0px\",\n            });\n            let renderedModal = (\n              <div\n                ref={observe}\n                id={`modal-${pane_fragment?.id}`}\n                className={\n                  inView ? \"paneFragment visible\" : \"paneFragment hidden\"\n                }\n                key={`modal-${pane_fragment?.id}`}\n              >\n                {this_fragment}\n              </div>\n            );\n\n            // add modal shape to stack\n            composedPaneFragments.push(\n              <div className={thisClass} key={`modal-${pane_fragment?.id}`}>\n                {renderedModal}\n              </div>\n            );\n          }\n          break;\n\n        case \"paragraph__background_pane\":\n          shape = thisViewportValue(state?.viewport?.viewport?.key, {\n            mobile: pane_fragment?.field_shape_mobile,\n            tablet: pane_fragment?.field_shape_tablet,\n            desktop: pane_fragment?.field_shape_desktop,\n          });\n          let this_options = {\n            viewport: state?.viewport?.viewport,\n            pane_height: pane_height,\n          };\n          tempValue = SvgShape(shape, this_options);\n          if (tempValue) payload.shapeData = tempValue.shape;\n          break;\n\n        case \"paragraph__background_video\":\n          payload.videoData = {\n            url: pane_fragment?.field_cdn_url,\n            alt_text: pane_fragment?.field_alt_text,\n          };\n          break;\n\n        case \"paragraph__svg\":\n          payload.imageData = [\n            {\n              url: pane_fragment?.relationships?.field_svg_file?.localFile\n                ?.publicURL,\n              alt_text: pane_fragment?.field_svg_file?.description,\n            },\n          ];\n          break;\n      }\n\n      // extract buttonData (if any)\n      if (\n        state?.controller?.payload?.buttons[pane?.id] &&\n        state?.controller?.payload?.buttons[pane?.id][pane_fragment?.id]\n      )\n        payload.buttonData =\n          state?.controller?.payload?.buttons[pane?.id][pane_fragment?.id];\n\n      // extract animation effects (if any)\n      if (\n        state?.controller?.payload?.effects[pane?.id] &&\n        state?.controller?.payload?.effects[pane?.id][pane_fragment?.id]\n      )\n        tempValue =\n          state?.controller?.payload?.effects[pane?.id][pane_fragment?.id];\n      if (tempValue && Object.keys(tempValue).length) {\n        for (const key in tempValue) {\n          // store animation\n          effects[`fragment-${pane_fragment?.id}`] = tempValue[key];\n          effects[`fragment-${pane_fragment?.id}`][\n            \"paneFragment\"\n          ] = `fragment-${pane_fragment?.id}`;\n          effects[`fragment-${pane_fragment?.id}`][\"pane\"] = pane?.id;\n          // clone and store animation for modal (if any)\n          if (\n            pane_fragment?.internal?.type === \"paragraph__modal\" ||\n            pane_fragment?.field_modal\n          ) {\n            effects[`modal-${pane_fragment?.id}`] = structuredClone(\n              tempValue[key]\n            );\n            effects[`modal-${pane_fragment?.id}`][\n              \"paneFragment\"\n            ] = `modal-${pane_fragment?.id}`;\n          }\n        }\n      }\n\n      // prepare any images from this paneFragment\n      pane_fragment?.relationships?.field_image?.map((e) => {\n        let this_image = thisViewportValue(state?.viewport?.viewport?.key, {\n          mobile: e?.mobile,\n          tablet: e?.tablet,\n          desktop: e?.desktop,\n        });\n        if (this_image) {\n          let this_imageData = {\n            id: e?.id,\n            filename: e?.filename,\n            data: this_image,\n            backgroundPosition:\n              pane_fragment?.field_background_position || null,\n          };\n          if (typeof pane_fragment?.field_alt_text === \"string\")\n            this_imageData.alt_text = pane_fragment?.field_alt_text;\n          payload.imageData.push(this_imageData);\n        }\n      });\n      // select css for viewport\n      payload.css_child = thisViewportValue(state?.viewport?.viewport?.key, {\n        mobile: pane_fragment?.field_css_styles_mobile || \"\",\n        tablet: pane_fragment?.field_css_styles_tablet || \"\",\n        desktop: pane_fragment?.field_css_styles_desktop || \"\",\n      });\n      payload.css_parent = thisViewportValue(state?.viewport?.viewport?.key, {\n        mobile: pane_fragment?.field_css_styles_parent_mobile || \"\",\n        tablet: pane_fragment?.field_css_styles_parent_tablet || \"\",\n        desktop: pane_fragment?.field_css_styles_parent_desktop || \"\",\n      });\n\n      // prepare structured data for this paneFragment\n      tractStackFragment = {\n        id: pane_fragment?.id,\n        mode: pane_fragment?.internal?.type,\n        pane_height_css: pane_height_css,\n        viewport: {\n          device: state?.viewport?.viewport?.key,\n          width: state?.viewport?.viewport?.width,\n        },\n        z_index: pane_fragment?.field_zindex,\n        children: payload?.children || {},\n        css: {\n          parent: payload?.css_parent || \"\",\n          child: payload?.css_child || \"\",\n        },\n        payload: {\n          imageData: payload?.imageData || [],\n          maskData: payload?.maskData || {},\n          hooksData: hooks || {},\n          videoData: payload?.videoData || {},\n          shapeData: payload?.shapeData || {},\n          modalData: payload?.modalData || {},\n          buttonData: payload?.buttonData || {},\n        },\n      };\n\n      let this_pane_fragment_type =\n        HasPaneFragmentType[tractStackFragment?.mode];\n      if (this_pane_fragment_type)\n        react_fragment = InjectPaneFragment(\n          tractStackFragment,\n          this_pane_fragment_type\n        );\n      else\n        console.log(\"ERROR in compose-panes.js: pane fragment type not found.\");\n\n      let thisClass = `paneFragment paneFragment__view paneFragment__view--${state?.viewport?.viewport?.key}`;\n      let renderedPaneFragment;\n\n      // are there effects?\n      if (typeof effects[`fragment-${pane_fragment?.id}`] === \"object\") {\n        const { observe, inView } = useInView({\n          unobserveOnEnter: true,\n          rootMargin: \"-100px 0px\",\n        });\n\n        renderedPaneFragment = (\n          <div\n            ref={observe}\n            id={`fragment-${pane_fragment?.id}`}\n            className={inView ? \"paneFragment visible\" : \"paneFragment hidden\"}\n            key={`fragment-${pane_fragment?.id}`}\n          >\n            {react_fragment}\n          </div>\n        );\n      } else\n        renderedPaneFragment = (\n          <div\n            id={`fragment-${pane_fragment?.id}`}\n            className=\"paneFragment\"\n            key={`fragment-${pane_fragment?.id}`}\n          >\n            {react_fragment}\n          </div>\n        );\n\n      // add the composed pane fragment\n      composedPaneFragments.push(\n        <div className={thisClass} key={pane_fragment?.id}>\n          {renderedPaneFragment}\n        </div>\n      );\n    });\n  // skip if empty pane\n  if (composedPaneFragments.length === 0) return;\n\n  // may we wrap this in animation?\n  if (state?.prefersReducedMotion?.prefersReducedMotion === false) {\n    for (const key in effects) {\n      let this_effects_payload = {\n        in: [effects[key]?.function, effects[key]?.speed, effects[key]?.delay],\n      };\n      let this_effects_css = InjectCssAnimation(\n        this_effects_payload,\n        effects[key]?.paneFragment\n      );\n      pane_css = `${pane_css} ${this_effects_css} `;\n    }\n  }\n\n  const { observe, inView } = useInView({\n    threshold: 0.25,\n    onEnter: ({}) => {\n      hooks?.hookPaneVisible(pane?.id);\n    },\n    onLeave: ({}) => {\n      hooks?.hookPaneHidden(pane?.id);\n    },\n  });\n\n  return (\n    <section key={pane?.id}>\n      <StyledWrapperDiv\n        ref={observe}\n        className={`pane pane__view pane__view--${state?.viewport?.viewport?.key}`}\n        css={pane_css}\n        id={pane?.id}\n      >\n        {composedPaneFragments}\n      </StyledWrapperDiv>\n    </section>\n  );\n};\n\nconst ComposePanes = (data) => {\n  // if viewport is not yet defined, return empty fragment\n  if (typeof data?.state?.viewport?.viewport?.key === \"undefined\") return <></>;\n\n  // loop through the panes in view and render each pane fragment\n  const composedPanes = data?.fragments?.relationships?.field_panes.map(\n    (pane, i) => {\n      return (\n        <ComposedPane\n          key={i}\n          data={{ pane: pane, state: data?.state, hooks: data?.hooks }}\n        />\n      );\n    }\n  );\n  // this is the storyFragment\n  if (typeof composedPanes === \"undefined\") return <></>;\n  return composedPanes;\n};\n\nexport { ComposePanes };\n"],"mappings":"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"}