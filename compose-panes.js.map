{"version":3,"sources":["src/compose-panes.js"],"names":["React","styled","toH","sanitize","h","MarkdownInjectGatsbyImage","StyledWrapper","div","props","css","StyleWrapper","children","parent_css","ComposePanes","data","relationships","field_panes","map","pane","index","field_pane_fragments","pane_fragment","imageData","field_image","image","id","filename","localFile","childImageSharp","gatsbyImageData","htmlAst","childPaneFragment","childMarkdownRemark","html","tag","__html","field_css_styles","field_css_styles_parent"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,SAASC,GAAT,QAAoB,qBAApB;AACA,SAASC,QAAT,QAAyB,oBAAzB;AACA,OAAOC,CAAP,MAAc,aAAd;AACA,SAASC,yBAAT,QAA0C,WAA1C;AAEA,MAAMC,aAAa,GAAGL,MAAM,CAACM,GAAI;AACjC,IAAKC,KAAD,IAAWA,KAAK,CAACC,GAAI;AACzB,CAFA;;AAGA,MAAMC,YAAY,GAAG,CAAC;AAAEC,EAAAA,QAAF;AAAYF,EAAAA,GAAZ;AAAiBG,EAAAA;AAAjB,CAAD,KAAmC;AACtD,sBACE,oBAAC,aAAD;AAAe,IAAA,GAAG,EAAEA;AAApB,kBACE,oBAAC,aAAD;AAAe,IAAA,GAAG,EAAEH;AAApB,KAA0BE,QAA1B,CADF,CADF;AAKD,CAND;;AAQA,MAAME,YAAY,GAAIC,IAAD,IAAU;AAC7B;AACA,SAAOA,IAAI,CAACA,IAAL,CAAUC,aAAV,CAAwBC,WAAxB,CAAoCC,GAApC,CAAwC,CAACC,IAAD,EAAOC,KAAP,KAAiB;AAC9D;AACA,WAAOD,IAAI,CAACH,aAAL,CAAmBK,oBAAnB,CAAwCH,GAAxC,CACL,CAACI,aAAD,EAAgBF,KAAhB,KAA0B;AACxB,UAAIG,SAAS,GAAGD,aAAa,CAACN,aAAd,CAA4BQ,WAA5B,CAAwCN,GAAxC,CAA6CO,KAAD,IAAW;AACrE,eAAO,CACLA,KAAK,CAACC,EADD,EAELD,KAAK,CAACE,QAFD,EAGLF,KAAK,CAACG,SAAN,CAAgBC,eAAhB,CAAgCC,eAH3B,CAAP;AAKD,OANe,CAAhB;AAOA,UAAIC,OAAO,GAAG3B,QAAQ,CACpBkB,aAAa,CAACU,iBAAd,CAAgCC,mBAAhC,CAAoDF,OADhC,CAAtB,CARwB,CAWxB;;AACA,UAAIG,IAAI,GAAG5B,yBAAyB,CAACyB,OAAD,EAAUR,SAAV,CAApC,CAZwB,CAaxB;;AACA,UAAIX,QAAQ,GAAGsB,IAAI,CAAChB,GAAL,CAAS,CAACiB,GAAD,EAAMf,KAAN,KAAgB;AACtC;AACA,YAAI,OAAOe,GAAP,KAAe,QAAnB,EAA6B;AAC3B,iBAAOA,GAAP;AACD,SAFD,MAEO,IAAI,OAAOA,GAAP,KAAe,QAAnB,EAA6B;AAClC,8BACE;AAAK,YAAA,GAAG,EAAEf,KAAV;AAAiB,YAAA,uBAAuB,EAAE;AAAEgB,cAAAA,MAAM,EAAED;AAAV;AAA1C,YADF;AAGD;AACF,OATc,CAAf;AAUA,0BACE,oBAAC,YAAD;AACE,QAAA,GAAG,EAAEf,KADP;AAEE,QAAA,GAAG,EAAEE,aAAa,CAACe,gBAFrB;AAGE,QAAA,UAAU,EAAEf,aAAa,CAACgB;AAH5B,SAKG1B,QALH,CADF;AASD,KAlCI,CAAP;AAoCD,GAtCM,CAAP;AAuCD,CAzCD;;AA2CA,SAASE,YAAT","sourcesContent":["import React from \"react\";\nimport styled from \"styled-components\";\nimport { toH } from \"hast-to-hyperscript\";\nimport { sanitize } from \"hast-util-sanitize\";\nimport h from \"hyperscript\";\nimport { MarkdownInjectGatsbyImage } from \"./helpers\";\n\nconst StyledWrapper = styled.div`\n  ${(props) => props.css};\n`;\nconst StyleWrapper = ({ children, css, parent_css }) => {\n  return (\n    <StyledWrapper css={parent_css}>\n      <StyledWrapper css={css}>{children}</StyledWrapper>\n    </StyledWrapper>\n  );\n};\n\nconst ComposePanes = (data) => {\n  // loop through the panes and render from markdown > htmlAst + css using styled-components\n  return data.data.relationships.field_panes.map((pane, index) => {\n    // each pane needs its field_css_styles_parent\n    return pane.relationships.field_pane_fragments.map(\n      (pane_fragment, index) => {\n        let imageData = pane_fragment.relationships.field_image.map((image) => {\n          return [\n            image.id,\n            image.filename,\n            image.localFile.childImageSharp.gatsbyImageData,\n          ];\n        });\n        let htmlAst = sanitize(\n          pane_fragment.childPaneFragment.childMarkdownRemark.htmlAst\n        );\n        // replace images with Gatsby Images\n        let html = MarkdownInjectGatsbyImage(htmlAst, imageData);\n        // render with styled-components and css\n        let children = html.map((tag, index) => {\n          // is either html as string OR is already a react element\n          if (typeof tag === \"object\") {\n            return tag;\n          } else if (typeof tag === \"string\") {\n            return (\n              <div key={index} dangerouslySetInnerHTML={{ __html: tag }} />\n            );\n          }\n        });\n        return (\n          <StyleWrapper\n            key={index}\n            css={pane_fragment.field_css_styles}\n            parent_css={pane_fragment.field_css_styles_parent}\n          >\n            {children}\n          </StyleWrapper>\n        );\n      }\n    );\n  });\n};\n\nexport { ComposePanes };\n"],"file":"compose-panes.js"}