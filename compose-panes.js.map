{"version":3,"file":"compose-panes.js","names":["React","useRef","renderToStaticMarkup","animateScrollTo","IsVisible","MarkdownParagraph","InjectGatsbyBackgroundImage","InjectGatsbyBackgroundVideo","InjectSvg","InjectSvgShape","InjectSvgModal","StyledWrapperDiv","InjectCssAnimation","getCurrentPane","thisViewportValue","SvgPane","SvgModal","SvgModals","ComposePanes","data","state","viewport","key","visiblePane","currentPane","panes","ref","document","getElementById","composedPanes","fragments","relationships","field_panes","map","pane","i","css","imageMaskShapes","textShapeOutside","modals","effects","background_colour","field_pane_fragments","filter","e","internal","type","this_selector","shape","pane_height_ratio","mobile","field_height_ratio_mobile","tablet","field_height_ratio_tablet","desktop","field_height_ratio_desktop","pane_height","pane_height_css","height_offset","field_height_offset_mobile","field_height_offset_tablet","field_height_offset_desktop","imageMaskShapeSelector","this_pane","field_image_mask_shape_mobile","field_image_mask_shape_tablet","field_image_mask_shape_desktop","console","log","selector","paneFragment","id","Boolean","composedPaneFragments","field_hidden_viewports","replace","split","indexOf","sort","a","b","field_zindex","pane_fragment","index","react_fragment","tractStackFragment","payload","tempValue","imageData","field_text_shape_outside_mobile","field_text_shape_outside_tablet","field_text_shape_outside_desktop","maskData","left_mask","right_mask","field_render_mobile","field_render_tablet","field_render_desktop","this_options","this_payload","this_fragment","this_shape","this_css","this_viewport","JSON","parse","render","device","width","cut","field_modal_shape","height","modal_shape","field_css_styles_parent_mobile","field_css_styles_parent_tablet","field_css_styles_parent_desktop","Object","keys","length","fragment","z_index","parent","modalData","SyntaxError","field_shape_mobile","field_shape_tablet","field_shape_desktop","paneData","videoData","url","field_cdn_url","alt_text","field_alt_text","field_svg_file","localFile","publicURL","description","childPaneFragment","childMarkdownRemark","htmlAst","children","value","field_options","action","buttons","buttonData","field_image","this_image","this_imageData","filename","push","css_child","field_css_styles_mobile","field_css_styles_tablet","field_css_styles_desktop","css_parent","mode","child","hooksData","hooks","thisClass","field_background_colour","this_modal","padding_left","padding_top","svgString","b64","window","btoa","dataUri","entries","forEach","prefersReducedMotion","this_effects_payload","in","function","speed","delay","this_effects_css"],"sources":["src/compose-panes.js"],"sourcesContent":["import React, { useRef } from \"react\";\nimport { renderToStaticMarkup } from \"react-dom/server\";\nimport animateScrollTo from \"animated-scroll-to\";\nimport { IsVisible } from \"./is-visible.js\";\nimport {\n  MarkdownParagraph,\n  InjectGatsbyBackgroundImage,\n  InjectGatsbyBackgroundVideo,\n  InjectSvg,\n  InjectSvgShape,\n  InjectSvgModal,\n  StyledWrapperDiv,\n  InjectCssAnimation,\n  getCurrentPane,\n  thisViewportValue,\n} from \"./helpers\";\nimport { SvgPane, SvgModal, SvgModals } from \"./shapes\";\n\nfunction ComposePanes(data) {\n  // if viewport is not yet defined, return empty fragment\n  if (typeof data?.state?.viewport?.viewport?.key === \"undefined\") return <></>;\n  // is there a current pane to scroll to?\n  let visiblePane = getCurrentPane(\n    data?.state?.viewport?.currentPane,\n    data?.state?.viewport?.panes\n  );\n  if (visiblePane) {\n    let ref = document.getElementById(visiblePane);\n    if (ref) animateScrollTo(ref);\n  }\n\n  // loop through the panes in view and render each pane fragment\n  const composedPanes = data?.fragments?.relationships?.field_panes.map(\n    (pane, i) => {\n      let css = \"\",\n        imageMaskShapes = {},\n        textShapeOutside = {},\n        modals = {},\n        effects = [];\n      // check for background colour\n      let background_colour = pane?.relationships?.field_pane_fragments.filter(\n        (e) => e?.internal?.type === \"paragraph__background_colour\"\n      );\n      // compose this pane\n      let this_selector, shape;\n      let pane_height_ratio = thisViewportValue(\n        data?.state?.viewport?.viewport?.key,\n        {\n          mobile: pane?.field_height_ratio_mobile,\n          tablet: pane?.field_height_ratio_tablet,\n          desktop: pane?.field_height_ratio_desktop,\n        }\n      );\n      let pane_height = thisViewportValue(\n        data?.state?.viewport?.viewport?.key,\n        {\n          mobile: pane_height_ratio * 10.8,\n          tablet: pane_height_ratio * 6,\n          desktop: pane_height_ratio * 19.2,\n        }\n      );\n      let pane_height_css = `calc((100vw - (var(--offset) * 1px)) * ${pane_height_ratio} / 100)`;\n      let height_offset = thisViewportValue(\n        data?.state?.viewport?.viewport?.key,\n        {\n          mobile: `calc((100vw - (var(--offset) * 1px)) / 600 * ${pane?.field_height_offset_mobile})`,\n          tablet: `calc((100vw - (var(--offset) * 1px)) / 1080 * ${pane?.field_height_offset_tablet})`,\n          desktop: `calc((100vw - (var(--offset) * 1px)) / 1920 * ${pane?.field_height_offset_desktop})`,\n        }\n      );\n\n      // generate imageMaskShape(s)\n      imageMaskShapes = pane?.relationships?.field_pane_fragments\n        .map((e) => {\n          let imageMaskShapeSelector;\n          let this_pane = thisViewportValue(\n            data?.state?.viewport?.viewport?.key,\n            {\n              mobile: e?.field_image_mask_shape_mobile,\n              tablet: e?.field_image_mask_shape_tablet,\n              desktop: e?.field_image_mask_shape_desktop,\n            }\n          );\n          if (typeof this_pane === \"string\" && this_pane !== \"none\") {\n            shape = SvgPane(this_pane, data?.state?.viewport?.viewport?.key);\n            switch (e?.internal?.type) {\n              case \"paragraph__background_video\":\n                imageMaskShapeSelector = \".paneFragmentVideo\";\n                break;\n              case \"paragraph__background_image\":\n                imageMaskShapeSelector = \".paneFragmentImage\";\n                break;\n              case \"paragraph__svg\":\n                imageMaskShapeSelector = \".paneFragmentSvg\";\n                break;\n              case \"paragraph__markdown\":\n                imageMaskShapeSelector = \".paneFragmentParagraph\";\n                break;\n              default:\n                console.log(\n                  \"compose-panes.js > imageMaskShapes: miss on\",\n                  e?.internal?.type\n                );\n            }\n          }\n          if (typeof shape === \"undefined\") return null;\n          return {\n            selector: imageMaskShapeSelector,\n            shape: shape,\n            paneFragment: e?.id,\n          };\n        })\n        .filter(Boolean);\n\n      // now compose the paneFragments for this pane\n      let composedPaneFragments = pane?.relationships?.field_pane_fragments\n        // skip if current viewport is listed in field_hidden_viewports\n        .filter(\n          (e) =>\n            e.field_hidden_viewports\n              .replace(/\\s+/g, \"\")\n              .split(\",\")\n              .indexOf(data?.state?.viewport?.viewport?.key) == -1\n        )\n        // already processed background_colour\n        .filter((e) => e?.internal?.type !== \"paragraph__background_colour\")\n        // sort by zIndex ***important\n        .sort((a, b) => (a?.field_zindex > b?.field_zindex ? 1 : -1))\n        .map((pane_fragment, index) => {\n          let react_fragment,\n            tractStackFragment,\n            payload = {},\n            tempValue,\n            shape;\n          payload.imageData = [];\n\n          // pre-pass paneFragment based on type\n          switch (pane_fragment?.internal?.type) {\n            case \"paragraph__markdown\":\n              shape = thisViewportValue(data?.state?.viewport?.viewport?.key, {\n                mobile: pane_fragment?.field_text_shape_outside_mobile,\n                tablet: pane_fragment?.field_text_shape_outside_tablet,\n                desktop: pane_fragment?.field_text_shape_outside_desktop,\n              });\n              // add shape outside if any\n              if (shape && shape !== \"none\") {\n                let tempValue = SvgPane(\n                  shape,\n                  data?.state?.viewport?.viewport?.key,\n                  \"shape-outside\"\n                );\n                if (tempValue)\n                  payload.maskData = {\n                    textShapeOutside: tempValue,\n                  };\n                // store shapeOutside to inject into pane\n                textShapeOutside[pane_fragment?.id] = {\n                  left_mask: tempValue?.left_mask,\n                  right_mask: tempValue?.right_mask,\n                };\n              }\n              break;\n\n            case \"paragraph__modal\":\n              tempValue = thisViewportValue(\n                data?.state?.viewport?.viewport?.key,\n                {\n                  mobile: pane_fragment?.field_render_mobile,\n                  tablet: pane_fragment?.field_render_tablet,\n                  desktop: pane_fragment?.field_render_desktop,\n                }\n              );\n              if (tempValue) {\n                let this_options,\n                  this_payload,\n                  this_fragment,\n                  this_shape,\n                  this_css,\n                  this_viewport;\n                try {\n                  this_options = JSON.parse(tempValue);\n                  if (typeof this_options?.render === \"object\") {\n                    this_payload = this_options?.render;\n                    this_payload.id = pane_fragment?.id;\n                    this_viewport = {\n                      device: data?.state?.viewport?.viewport?.key,\n                      width: data?.state?.viewport?.viewport?.width,\n                    };\n                    this_payload.viewport = this_viewport;\n                    this_payload.cut =\n                      SvgModals[pane_fragment?.field_modal_shape][\"cut\"];\n                    this_payload.height =\n                      SvgModals[pane_fragment?.field_modal_shape][\"viewBox\"][1];\n                    this_payload.pane_height = pane_height;\n                    this_shape = SvgModal(\n                      pane_fragment?.field_modal_shape,\n                      this_payload\n                    );\n                    this_fragment = InjectSvgModal(\n                      this_shape?.modal_shape,\n                      this_payload\n                    );\n                    this_css = thisViewportValue(\n                      data?.state?.viewport?.viewport?.key,\n                      {\n                        mobile: pane_fragment?.field_css_styles_parent_mobile,\n                        tablet: pane_fragment?.field_css_styles_parent_tablet,\n                        desktop: pane_fragment?.field_css_styles_parent_desktop,\n                      }\n                    );\n                    // add modal to inject in pane later\n                    modals[Object.keys(modals).length] = {\n                      id: pane_fragment?.id,\n                      fragment: this_fragment,\n                      z_index: pane_fragment?.field_zindex,\n                      css: {\n                        parent: this_css,\n                      },\n                      payload: {\n                        modalData: {\n                          render: this_options?.render,\n                          shape: this_shape,\n                        },\n                      },\n                    };\n                  }\n                  // store shapeOutside to inject into pane\n                  textShapeOutside[pane_fragment?.id] = this_shape;\n                  payload.maskData = { textShapeOutside: this_shape };\n                } catch (e) {\n                  if (e instanceof SyntaxError) {\n                    console.log(\"ERROR parsing json in {}: \", e);\n                  }\n                }\n              }\n\n            case \"paragraph__background_pane\":\n              shape = thisViewportValue(data?.state?.viewport?.viewport?.key, {\n                mobile: pane_fragment?.field_shape_mobile,\n                tablet: pane_fragment?.field_shape_tablet,\n                desktop: pane_fragment?.field_shape_desktop,\n              });\n              tempValue = SvgPane(shape, data?.state?.viewport?.viewport?.key);\n              if (tempValue) payload.paneData = tempValue;\n              break;\n\n            case \"paragraph__background_video\":\n              payload.videoData = {\n                url: pane_fragment?.field_cdn_url,\n                alt_text: pane_fragment?.field_alt_text,\n              };\n              break;\n\n            case \"paragraph__svg\":\n              payload.imageData = [\n                {\n                  url: pane_fragment?.relationships?.field_svg_file?.localFile\n                    ?.publicURL,\n                  alt_text: pane_fragment?.field_svg_file?.description,\n                },\n              ];\n              break;\n          }\n\n          // prepare any markdown for this paneFragment\n          if (pane_fragment?.childPaneFragment?.childMarkdownRemark?.htmlAst) {\n            payload.children =\n              pane_fragment?.childPaneFragment?.childMarkdownRemark?.htmlAst;\n            payload.children.children =\n              pane_fragment?.childPaneFragment?.childMarkdownRemark?.htmlAst?.children?.filter(\n                (e) => !(e.type === \"text\" && e.value === \"\\n\")\n              );\n          }\n          // extract animation effects or buttonData (if any)\n          if (typeof pane_fragment?.field_options === \"string\") {\n            let action;\n            try {\n              action = JSON.parse(pane_fragment?.field_options);\n              if (typeof tempValue?.buttons === \"object\")\n                payload.buttonData = tempValue?.buttons;\n              // effects are directly injected into each pane below\n              if (typeof action?.effects === \"object\") {\n                for (const key in action?.effects) {\n                  effects[pane_fragment?.id] = action?.effects[key];\n                  effects[pane_fragment?.id][\"paneFragment\"] =\n                    pane_fragment?.id;\n                  effects[pane_fragment?.id][\"pane\"] = pane?.id;\n                  if (pane_fragment?.internal?.type === \"paragraph__modal\") {\n                    effects[`${pane_fragment?.id}-modal`] =\n                      action?.effects[key];\n                    effects[`${pane_fragment?.id}-modal`][\n                      \"paneFragment\"\n                    ] = `${pane_fragment?.id}-modal`;\n                    effects[`${pane_fragment?.id}-modal`][\"pane\"] = pane?.id;\n                  }\n                }\n              }\n            } catch (e) {\n              if (e instanceof SyntaxError) {\n                console.log(\"ERROR parsing json in compose-panes.js: \", e);\n              }\n            }\n          }\n          // prepare any images from this paneFragment\n          pane_fragment?.relationships?.field_image?.map((e) => {\n            let this_image = thisViewportValue(\n              data?.state?.viewport?.viewport?.key,\n              {\n                mobile: e?.mobile,\n                tablet: e?.tablet,\n                desktop: e?.desktop,\n              }\n            );\n            if (this_image) {\n              let this_imageData = {\n                id: e?.id,\n                filename: e?.filename,\n                data: this_image,\n              };\n              if (typeof pane_fragment?.field_alt_text === \"string\")\n                this_imageData.alt_text = pane_fragment?.field_alt_text;\n              payload.imageData.push(this_imageData);\n            }\n          });\n          // select css for viewport\n          payload.css_child = thisViewportValue(\n            data?.state?.viewport?.viewport?.key,\n            {\n              mobile: pane_fragment?.field_css_styles_mobile || \"\",\n              tablet: pane_fragment?.field_css_styles_tablet || \"\",\n              desktop: pane_fragment?.field_css_styles_desktop || \"\",\n            }\n          );\n          payload.css_parent = thisViewportValue(\n            data?.state?.viewport?.viewport?.key,\n            {\n              mobile: pane_fragment?.field_css_styles_parent_mobile || \"\",\n              tablet: pane_fragment?.field_css_styles_parent_tablet || \"\",\n              desktop: pane_fragment?.field_css_styles_parent_desktop || \"\",\n            }\n          );\n\n          // prepare structured data for this paneFragment\n          tractStackFragment = {\n            id: pane_fragment?.id,\n            mode: pane_fragment?.internal?.type,\n            viewport: {\n              device: data?.state?.viewport?.viewport?.key,\n              width: data?.state?.viewport?.viewport?.width,\n            },\n            z_index: pane_fragment?.field_zindex,\n            children: payload?.children || {},\n            css: {\n              parent: payload?.css_parent || \"\",\n              child: payload?.css_child || \"\",\n            },\n            payload: {\n              imageData: payload?.imageData || [],\n              maskData: payload?.maskData || {},\n              hooksData: data?.hooks || {},\n              videoData: payload?.videoData || {},\n              paneData: payload?.paneData || {},\n              modalData: payload?.modalData || {},\n            },\n          };\n\n          // generate react for this paneFragment\n          switch (tractStackFragment?.mode) {\n            case \"paragraph__markdown\":\n            case \"paragraph__modal\":\n              react_fragment = MarkdownParagraph(tractStackFragment);\n              break;\n\n            case \"paragraph__background_pane\":\n              react_fragment = InjectSvgShape(tractStackFragment);\n              break;\n\n            case \"paragraph__background_image\":\n              react_fragment = InjectGatsbyBackgroundImage(tractStackFragment);\n              break;\n\n            case \"paragraph__background_video\":\n              react_fragment = InjectGatsbyBackgroundVideo(tractStackFragment);\n              break;\n\n            case \"paragraph__svg\":\n              react_fragment = InjectSvg(tractStackFragment);\n              break;\n\n            case \"paragraph__d3\":\n              //\n              break;\n\n            case \"paragraph__h5p\":\n              //\n              break;\n\n            default:\n              console.log(\n                \"MISS on compose-panes.js:\",\n                tractStackFragment?.mode\n              );\n          }\n\n          let thisClass = `paneFragment paneFragment__view paneFragment__view--${data?.state?.viewport?.viewport?.key}`;\n          return (\n            <div className={thisClass} key={pane_fragment?.id}>\n              <IsVisible\n                id={pane_fragment?.id}\n                className=\"paneFragment\"\n                key={pane_fragment?.id}\n              >\n                {react_fragment}\n              </IsVisible>\n            </div>\n          );\n        });\n\n      // skip if empty pane\n      if (Object.keys(composedPaneFragments).length === 0) return;\n\n      // now render the pane\n      // prepare css for pane\n      css = `${css} height: ${pane_height_css}; margin-bottom: ${height_offset};`;\n      if (background_colour.length)\n        css = `${css} background-color: ${background_colour[0].field_background_colour};`;\n      // inject modal(s) if any\n      if (Object.keys(modals).length)\n        Object.keys(modals).map((i) => {\n          let this_modal = modals[i];\n          console.log(this_modal?.payload?.modalData?.render);\n          css =\n            `${css} ${this_modal?.css?.parent} ` +\n            `#${this_modal?.id} svg.svg-shape-outside-left { ` +\n            `z-index: ${this_modal?.z_index - 1};` +\n            `width: calc((100vw - (var(--offset) * 1px)) / ${this_modal?.payload?.modalData?.render?.viewport?.width} * ${this_modal?.payload?.modalData?.render?.cut}); ` +\n            `height: calc((100vw - (var(--offset) * 1px)) / ${this_modal?.payload?.modalData?.render?.viewport?.width} * ${this_modal?.payload?.modalData?.render?.height}); ` +\n            `margin-left: calc((100vw - (var(--offset) * 1px)) / ${this_modal?.payload?.modalData?.render?.viewport?.width} * ${this_modal?.payload?.modalData?.render?.padding_left}); ` +\n            `margin-right: 0; ` +\n            `margin-top: calc((100vw - (var(--offset) * 1px)) / ${this_modal?.payload?.modalData?.render?.viewport?.width} * ${this_modal?.payload?.modalData?.render?.padding_top}); ` +\n            `} ` +\n            `#${this_modal?.id} svg.svg-shape-outside-right { ` +\n            `z-index: ${this_modal?.z_index - 1};` +\n            `width: calc((100vw - (var(--offset) * 1px)) / ${\n              this_modal?.payload?.modalData?.render?.viewport?.width\n            } * ${\n              this_modal?.payload?.modalData?.render?.width -\n              this_modal?.payload?.modalData?.render?.cut\n            }); ` +\n            `height: calc((100vw - (var(--offset) * 1px)) / ${this_modal?.payload?.modalData?.render?.viewport?.width} * ${this_modal?.payload?.modalData?.render?.height}); ` +\n            `margin-left: 0; ` +\n            `margin-right: calc((100vw - (var(--offset) * 1px)) / ${\n              this_modal?.payload?.modalData?.render?.viewport?.width\n            } * ${\n              this_modal?.payload?.modalData?.render?.viewport?.width -\n              this_modal?.payload?.modalData?.render?.padding_left -\n              this_modal?.payload?.modalData?.render?.width\n            }); ` +\n            `margin-top: calc((100vw - (var(--offset) * 1px)) / ${this_modal?.payload?.modalData?.render?.viewport?.width} * ${this_modal?.payload?.modalData?.render?.padding_top}); ` +\n            `} ` +\n            `#${this_modal?.id}-svg-modal svg { ` +\n            `z-index: ${this_modal?.z_index - 1}; ` +\n            `width: calc((100vw - (var(--offset) * 1px)) / ${this_modal?.payload?.modalData?.render?.viewport?.width} * ${this_modal?.payload?.modalData?.render?.width}); ` +\n            `margin-left: calc((100vw - (var(--offset) * 1px)) / ${this_modal?.payload?.modalData?.render?.viewport?.width} * ${this_modal?.payload?.modalData?.render?.padding_left}); ` +\n            `margin-top: calc((100vw - (var(--offset) * 1px)) / ${this_modal?.payload?.modalData?.render?.viewport?.width} * ${this_modal?.payload?.modalData?.render?.padding_top}); ` +\n            `}`;\n          // add this modal to composedPaneFragments\n          composedPaneFragments[Object.keys(composedPaneFragments).length] = (\n            <div\n              className={`paneFragment paneFragment__view paneFragment__view--${data?.state?.viewport?.viewport?.key}`}\n              key={`${this_modal?.id}-modal`}\n            >\n              <IsVisible\n                id={`${this_modal?.id}-modal`}\n                className=\"paneFragment\"\n                key={`${this_modal?.id}-visible`}\n              >\n                {this_modal?.fragment}\n              </IsVisible>\n            </div>\n          );\n        });\n      // inject imageMaskShape(s) (if any)\n      if (Object.keys(imageMaskShapes).length)\n        imageMaskShapes.map((e) => {\n          if (typeof e?.shape === \"object\") {\n            let svgString = renderToStaticMarkup(e?.shape);\n            let b64 = window.btoa(svgString);\n            let dataUri = `data:image/svg+xml;base64,${b64}`;\n            css =\n              `${css} ${e?.selector} {-webkit-mask-image: url(\"${dataUri}\"); mask-image: url(\"${dataUri}\");` +\n              ` mask-repeat: no-repeat; -webkit-mask-size: 100% AUTO; mask-size: 100% AUTO; }`;\n          }\n        });\n      // inject textShapeOutside(s) (if any)\n      Object.entries(textShapeOutside).forEach(([key, value]) => {\n        css =\n          `${css} #${key} .paneFragmentParagraph { svg.svg-shape-outside-left {float:left;shape-outside:url(${value?.left_mask})} ` +\n          `svg.svg-shape-outside-right {float:right;shape-outside:url(${value?.right_mask})} }`;\n      });\n\n      // may we wrap this in animation?\n      if (data?.state?.prefersReducedMotion?.prefersReducedMotion === false) {\n        for (const key in effects) {\n          if (effects[key]?.pane === pane?.id) {\n            let this_effects_payload = {\n              in: [\n                effects[key]?.function,\n                effects[key]?.speed,\n                effects[key]?.delay,\n              ],\n            };\n            let this_effects_css = InjectCssAnimation(\n              this_effects_payload,\n              effects[key]?.paneFragment\n            );\n            css = `${css} ${this_effects_css} `;\n          }\n        }\n      }\n      return (\n        <section key={pane?.id}>\n          <IsVisible id={pane?.id} hooks={data?.hooks}>\n            <StyledWrapperDiv\n              className={`pane pane__view pane__view--${data?.state?.viewport?.viewport?.key}`}\n              css={css}\n            >\n              {composedPaneFragments}\n            </StyledWrapperDiv>\n          </IsVisible>\n        </section>\n      );\n    }\n  );\n\n  // this is the storyFragment\n  return composedPanes;\n}\n\nexport { ComposePanes };\n"],"mappings":"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"}