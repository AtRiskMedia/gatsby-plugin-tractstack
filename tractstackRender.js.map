{"version":3,"sources":["src/tractstackRender.js"],"names":["React","useContext","GatsbyImage","getImage","DOMPurify","SvgPane","SvgLogo","SvgPlay","SvgRewind","TractStackContext","ScrollRevealContainer","TractStackRender","data","console","log","context","storystep","pixelWidth","local_storystep","JSON","parse","localStorage","getItem","setItem","stringify","value","relationships","field_storysteps","length","slidedeck","SlideDeck","name","filter","e","field_storystep_order","field_storystep_name","num_storysteps","Object","prototype","hasOwnProperty","call","Contents","children","Revealed","rows","Set","sort","a","b","row","map","slide","tractstack","toString","key","scrollRevealOptions","className","copy","svg_name","width","field_storystep_slides","svg","field_row_360","field_svg_360","field_row_1080","field_svg_1080","field_row_1920","field_svg_1920","parseInt","drupal_internal__nid","field_content","field_scroll_reveal_options","field_classname","ActionLink","button_text","action","handleClick","preventDefault","actions","nextStorystep","prevStorystep","TractStackSlide","allcopy","internal","type","clean","sanitize","field_innerhtml","drupal_internal__id","__html","field_button_text","actions_payload","field_actions_payload","field_image","localFile","childImageSharp","gatsbyImageData","field_alt_text","pad","num","size","TrackStackController","storystep_name","svg__storystep","Controls","play","rew"],"mappings":"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","sourcesContent":["/* global localStorage */\n/* eslint-disable react/prop-types */\nimport React, {useContext} from 'react';\nimport {GatsbyImage, getImage} from 'gatsby-plugin-image';\nimport DOMPurify from 'dompurify';\nimport {SvgPane, SvgLogo, SvgPlay, SvgRewind} from './svg';\nimport {TractStackContext} from './provider';\nimport ScrollRevealContainer from './ScrollRevealContainer';\n\nexport function TractStackRender(data) {\n  console.log( \"TractStackRender\" );\n  //localStorage.clear();\n  const context = useContext(TractStackContext);\n  let storystep = context.storystep,\n    pixelWidth = context.pixelWidth;\n  const local_storystep = JSON.parse(localStorage.getItem('storystep'));\n  // if no context exists yet with storystep, use 1\n  // DEBUG: remove this\n  if (!pixelWidth) {\n    pixelWidth = \"360\";\n  }\n  if (!storystep) {\n    storystep = 1;\n    localStorage.setItem('storystep', JSON.stringify(1));\n    localStorage.setItem(\n      'num_storysteps',\n      JSON.stringify(data.value.relationships.field_storysteps.length)\n    );\n  } else if (local_storystep && storystep !== local_storystep) {\n    // use localStorage storystep if available\n    storystep = local_storystep;\n  }\n  let slidedeck = {\n    360: SlideDeck(360, storystep, data),\n    1080: SlideDeck(1080, storystep, data),\n    1920: SlideDeck(1920, storystep, data),\n    storystep: {\n      storystep: storystep,\n      name: data.value.relationships.field_storysteps.filter(\n        (e) => e.field_storystep_order === storystep\n      )[0].field_storystep_name,\n      num_storysteps: data.value.relationships.field_storysteps.length,\n    },\n  };\n  console.log( pixelWidth, typeof slidedeck );\n  console.log( slidedeck );\n  if (\n    pixelWidth &&\n    typeof slidedeck !== 'undefined' &&\n    typeof slidedeck == 'object' &&\n    Object.prototype.hasOwnProperty.call(slidedeck, 360) &&\n    Object.prototype.hasOwnProperty.call(slidedeck, 1080) &&\n    Object.prototype.hasOwnProperty.call(slidedeck, 1920) &&\n    Object.prototype.hasOwnProperty.call(slidedeck, 'storystep')\n  ) {\n    const Contents = ({children}) => <div>{children}</div>;\n    const Revealed = ScrollRevealContainer(Contents);\n\n    let rows = [\n      ...new Set(\n        slidedeck[pixelWidth]\n          .filter((e) => e.storystep === storystep)\n          .sort(function (a, b) {\n            return a.row - b.row;\n          })\n          .map(function (slide) {\n            return slide.row;\n          })\n      ),\n    ];\n    return (\n      <TractStackContext.Consumer>\n        {(tractstack) => (\n          <>\n            <div className={'pixelWidth__' + pixelWidth}>\n              <TrackStackController\n                value={{\n                  data: {\n                    slidedeck: slidedeck,\n                    context: tractstack,\n                  },\n                }}\n              />\n              {rows.map(function (row) {\n                return (\n                  <div\n                    className={\n                      'tractstack tractstack__container row' + row.toString()\n                    }\n                    key={row}\n                  >\n                    {slidedeck[pixelWidth]\n                      .filter((e) => e.storystep === storystep)\n                      .filter((e) => e.row === row)\n                      .map(function (slide) {\n                        // build slide\n                        return (\n                          <div className=\"pane .load-hidden\" key={slide.key}>\n                            <Revealed\n                              options={slide.scrollRevealOptions}\n                              interval={50}\n                              target={\n                                '.tractstack__container--' +\n                                slide.className +\n                                '-' +\n                                pixelWidth.toString()\n                              }\n                            >\n                              <>\n                                <TractStackSlide\n                                  value={{\n                                    key: slide.key,\n                                    copy: slide.copy,\n                                    svg_name: slide.svg_name,\n                                    className: slide.className,\n                                    pixelWidth: pixelWidth,\n                                  }}\n                                />\n                              </>\n                            </Revealed>\n                          </div>\n                        );\n                      })}\n                  </div>\n                );\n              })}\n            </div>\n          </>\n        )}\n      </TractStackContext.Consumer>\n    );\n  }\n  return <></>;\n}\n\nfunction SlideDeck(width, storystep, data) {\n  return data.value.relationships.field_storysteps\n    .filter((e) => e.field_storystep_order === storystep)[0]\n    .relationships.field_storystep_slides.map(function (e) {\n      let row, svg;\n      if (width === 360) {\n        row = e.field_row_360;\n        svg = e.field_svg_360;\n      } else if (width === 1080) {\n        row = e.field_row_1080;\n        svg = e.field_svg_1080;\n      } else if (width === 1920) {\n        row = e.field_row_1920;\n        svg = e.field_svg_1920;\n      } else return {};\n      if (row === -1) return {};\n      return {\n        key: parseInt(width.toString() + '0' + e.drupal_internal__nid),\n        storystep: storystep,\n        row: row,\n        copy: e.relationships.field_content,\n        scrollRevealOptions: e.field_scroll_reveal_options,\n        className: e.field_classname,\n        svg_name: svg,\n      };\n    });\n}\n\nfunction ActionLink(button_text, className, key, action) {\n  const context = useContext(TractStackContext);\n  function handleClick(e) {\n    e.preventDefault();\n    switch (action) {\n      case 'nextStorystep':\n        context.actions.nextStorystep();\n        break;\n      case 'prevStorystep':\n        context.actions.prevStorystep();\n        break;\n    }\n  }\n  return (\n    <div\n      className={\n        'pane pane__copy pane__copy--action pane__copy--action-' + className\n      }\n      key={key}\n    >\n      <div>\n        <button href=\"#\" onClick={handleClick} className=\"neon-button\">\n          {button_text}\n        </button>\n      </div>\n    </div>\n  );\n}\n\nfunction TractStackSlide(data) {\n  if (\n    typeof data !== 'undefined' &&\n    typeof data == 'object' &&\n    typeof data.value !== 'undefined' &&\n    typeof data.value.copy !== 'undefined' &&\n    typeof data.value.copy == 'object' &&\n    typeof data.value.svg_name !== 'undefined' &&\n    typeof data.value.svg_name == 'string' &&\n    typeof data.value.pixelWidth !== 'undefined' &&\n    typeof data.value.pixelWidth == 'number'\n  ) {\n    const allcopy = data.value.copy.map(function (copy) {\n      switch (copy.internal.type) {\n        case 'paragraph__text':\n          var clean = DOMPurify.sanitize(copy.field_innerhtml);\n          return (\n            <div\n              key={copy.drupal_internal__id}\n              className={'pane pane__copy pane__copy--' + copy.field_classname}\n            >\n              <div dangerouslySetInnerHTML={{__html: clean}}></div>\n            </div>\n          );\n        case 'paragraph__action':\n          var button_text = DOMPurify.sanitize(copy.field_button_text);\n          var actions_payload = JSON.parse(copy.field_actions_payload);\n          return ActionLink(\n            button_text,\n            copy.field_classname,\n            copy.drupal_internal__id,\n            actions_payload['action']\n          );\n        case 'paragraph__image':\n          return (\n            <div\n              key={copy.drupal_internal__id}\n              className={\n                'pane pane__image pane__imagemask--' + copy.field_classname\n              }\n            >\n              <GatsbyImage\n                image={getImage(\n                  copy.relationships.field_image.localFile.childImageSharp\n                    .gatsbyImageData\n                )}\n                className={'pane pane__image--' + copy.field_classname}\n                alt={copy.field_alt_text}\n              />\n            </div>\n          );\n      }\n    });\n    return (\n      <div\n        className={\n          'tractstack tractstack__container--' +\n          data.value.svg_name +\n          ' tractstack__container--' +\n          data.value.className +\n          '-' +\n          data.value.pixelWidth.toString()\n        }\n      >\n        <div\n          className={\n            'pane tractstack__svg tractstack__svg--' + data.value.className\n          }\n        >\n          {SvgPane(\n            data.value.pixelWidth.toString(),\n            data.value.svg_name,\n            data.value.className\n          )}\n        </div>\n        {allcopy}\n      </div>\n    );\n  }\n  return <></>;\n}\n\nfunction pad(num, size) {\n  num = num.toString();\n  while (num.length < size) num = '0' + num;\n  return num;\n}\n\nexport function TrackStackController(data) {\n  if (\n    typeof data !== 'undefined' &&\n    typeof data == 'object' &&\n    typeof data.value !== 'undefined' &&\n    typeof data.value.data !== 'undefined' &&\n    typeof data.value.data == 'object' &&\n    Object.prototype.hasOwnProperty.call(data.value.data.slidedeck, 360) &&\n    Object.prototype.hasOwnProperty.call(data.value.data.slidedeck, 1080) &&\n    Object.prototype.hasOwnProperty.call(data.value.data.slidedeck, 1920) &&\n    Object.prototype.hasOwnProperty.call(data.value.data.slidedeck, 'storystep')\n  ) {\n    const context = useContext(TractStackContext);\n    let pixelWidth = context.pixelWidth;\n    // DEBUG: remove this\n    if (!pixelWidth) {\n      pixelWidth = \"360\";\n    }\n    let num_storysteps = JSON.parse(localStorage.getItem('num_storysteps'));\n    let storystep = data.value.data.slidedeck.storystep.storystep;\n    let storystep_name = data.value.data.slidedeck.storystep.name;\n    let svg = SvgPane(pixelWidth.toString(), 'controller', 'controller');\n    let svg__storystep = SvgPane(\n      pixelWidth.toString(),\n      'controller',\n      'storystep',\n      'clip'\n    );\n    const Controls = () => {\n      let play = false,\n        rew = false;\n      if (storystep < num_storysteps) play = true;\n      if (storystep > 1) rew = true;\n      return (\n        <div className=\"pane\">\n          <div className=\"tractstack__controller--controls\">\n            {play && context && context.actions && context.actions.nextStorystep && <SvgPlay value={context.actions.nextStorystep} />}\n            {rew && context && context.actions && context.actions.prevStorystep && <SvgRewind value={context.actions.prevStorystep} />}\n          </div>\n        </div>\n      );\n    };\n\n    if (storystep && storystep_name && svg && svg__storystep) {\n      return (\n        <div className=\"tractstack tractstack__controller\">\n          <div className=\"pane tractstack__svg svg__controller\">{svg}</div>\n          <div className=\"pane tractstack__svg svg__storystep\">\n            {svg__storystep}\n          </div>\n          <div className=\"pane\">\n            <div className=\"tractstack__controller--storystep\">\n              <p>\n                Story\n                <br />\n                step\n              </p>\n              <div>{pad(storystep, 2)}</div>\n            </div>\n          </div>\n          <div className=\"pane\">\n            <div className=\"tractstack__controller--name\">\n              <SvgLogo /> <h1>{storystep_name}</h1>\n            </div>\n          </div>\n          <Controls />\n        </div>\n      );\n    }\n  }\n  return <></>;\n}\n"],"file":"tractstackRender.js"}